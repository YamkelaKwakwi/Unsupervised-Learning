"0","# Faceted MDS plot based on the ""major"" cell types"
"0","p2_mds <- ggplot(mds_tibble, aes(x = mds1, y = mds2)) +"
"0","  theme_cowplot() +"
"0","  background_grid(major = ""xy"") +"
"0","  geom_point("
"0","    aes(colour = major_minor, shape = major_minor),"
"0","    size = 2.5, alpha = 0.8"
"0","  ) +"
"0","  scale_color_manual(values = col_lab_minor) +"
"0","  scale_shape_manual(values = shape_lab_minor) +"
"0","  geom_text_repel("
"0","    data = mds_tibble %>%"
"0","      group_by(major_minor, major) %>%"
"0","      summarise(mds1_mean = mean(mds1),"
"0","                mds2_mean = mean(mds2),"
"0","                .groups = ""drop""),"
"0","    aes(x = mds1_mean, y = mds2_mean, label = major_minor),"
"0","    size = 2.5, alpha = 0.8, inherit.aes = FALSE, max.overlaps = 100"
"0","  ) +"
"0","  facet_wrap(~major, ncol = 3, scales = ""free"") +"
"0","  labs("
"0","    title = ""MDS of Flow Cytometry for each major cell population"","
"0","    y = ""MDS 1"","
"0","    x = ""MDS 2"","
"0","    color = ""Cell type"","
"0","    shape = ""Major Cell type"""
"0","  ) +"
"0","  theme(legend.position = ""none"")"
"0",""
"0",""
"0","p2_mds"
