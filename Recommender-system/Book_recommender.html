<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yamkela Kwakwi">

<title>Book Recommender System</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Book_recommender_files/libs/clipboard/clipboard.min.js"></script>
<script src="Book_recommender_files/libs/quarto-html/quarto.js"></script>
<script src="Book_recommender_files/libs/quarto-html/popper.min.js"></script>
<script src="Book_recommender_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Book_recommender_files/libs/quarto-html/anchor.min.js"></script>
<link href="Book_recommender_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Book_recommender_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Book_recommender_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Book_recommender_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Book_recommender_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Book_recommender_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Book_recommender_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="Book_recommender_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="Book_recommender_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="Book_recommender_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="Book_recommender_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="Book_recommender_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="Book_recommender_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="Book_recommender_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="Book_recommender_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Book Recommender System</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yamkela Kwakwi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this project we will use the Book-Crossing dataset <a href="https://www.kaggle.com/datasets/arashnic/book-recommendation-dataset?resource=download">here</a>, from Kaggle to build a recommender system for books.The dataset contains three files</p>
<ul>
<li>Users.csv: anonymized <code>userId</code> and user demorgraphic (<code>age</code>, <code>location</code>) where available.</li>
<li>Books.csv : valid <code>ISBN</code>, basic information about the book (<code>Book-Title</code>, <code>Book-Author</code>, <code>Year-Of-Publication</code>, <code>Publisher</code>) and extra cover image URLs in different sizes (<code>Image-URL-S</code>, <code>Image-URL-M</code>, <code>Image-URL-L</code>).</li>
<li>Ratings.csv : explicit, scaled or implicit ratings (<code>Book-Rating</code>)</li>
</ul>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li>Build recommender systems based on various collaborative filtering approaches</li>
</ol>
<ul>
<li>user-based (UB)</li>
<li>item-based (IB))</li>
<li>matrix factorization</li>
</ul>
<ol start="2" type="1">
<li><p>Use cross-validation to evaluate the accuracy of the matrix factorization recommender system with and without regularization.</p></li>
<li><p>Build an ensemble model using the three collaborative filtering approached and evaluate the accuracy.</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'proxy'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    as.matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    as.dist, dist</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    as.matrix</code></pre>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data exploration</h2>
<p>The datasets are very large, with the observations for the books, users and ratings being 271 360, 278 858 and 1 149 780, respectively. Rating has a lot more observations than book and users because one user can rate a book multiple times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the number of observations and features for data</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(books)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 271360      8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(users)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 278858      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ratings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1149780       3</code></pre>
</div>
</div>
<p>There is information on a total of 271 360 books in the books dataset, but in ratings there is a total of 340 556 books. For these extra books in ratings we do not have information either than the ISBN for them. In the users dataset, there is a total of 278 858 unique user ids, however, only 105 283 unique users have rated books. So more than half of the users in the system have not rated even a single book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How many books are rated of the books in in the book dataset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(books<span class="sc">$</span>ISBN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 271360</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(ratings<span class="sc">$</span>ISBN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 340556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How many users have rating out of the users in in the users dataset</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(users<span class="sc">$</span>User.ID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 278858</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(ratings<span class="sc">$</span>User.ID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105283</code></pre>
</div>
</div>
</section>
<section id="data-engineering" class="level2">
<h2 class="anchored" data-anchor-id="data-engineering">Data engineering</h2>
<section id="changing-column-names" class="level3">
<h3 class="anchored" data-anchor-id="changing-column-names">Changing column names</h3>
<p>We will change the column names in all the datasets into simpler names that are all in lower case for ease while working with the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Original data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(users, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  User.ID                        Location Age
1       1              nyc, new york, usa  NA
2       2       stockton, california, usa  18
3       3 moscow, yukon territory, russia  NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(users)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "User.ID"  "Location" "Age"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename the colnames</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>users <span class="ot">&lt;-</span> users <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">"user_id"</span> <span class="ot">=</span> <span class="st">"User.ID"</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"location"</span><span class="ot">=</span> <span class="st">"Location"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"age"</span> <span class="ot">=</span> <span class="st">"Age"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(users,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  user_id                        location age
1       1              nyc, new york, usa  NA
2       2       stockton, california, usa  18
3       3 moscow, yukon territory, russia  NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Original data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(books, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        ISBN           Book.Title          Book.Author Year.Of.Publication
1 0195153448  Classical Mythology   Mark P. O. Morford                2002
2 0002005018         Clara Callan Richard Bruce Wright                2001
3 0060973129 Decision in Normandy         Carlo D'Este                1991
                Publisher
1 Oxford University Press
2   HarperFlamingo Canada
3         HarperPerennial
                                                   Image.URL.S
1 http://images.amazon.com/images/P/0195153448.01.THUMBZZZ.jpg
2 http://images.amazon.com/images/P/0002005018.01.THUMBZZZ.jpg
3 http://images.amazon.com/images/P/0060973129.01.THUMBZZZ.jpg
                                                   Image.URL.M
1 http://images.amazon.com/images/P/0195153448.01.MZZZZZZZ.jpg
2 http://images.amazon.com/images/P/0002005018.01.MZZZZZZZ.jpg
3 http://images.amazon.com/images/P/0060973129.01.MZZZZZZZ.jpg
                                                   Image.URL.L
1 http://images.amazon.com/images/P/0195153448.01.LZZZZZZZ.jpg
2 http://images.amazon.com/images/P/0002005018.01.LZZZZZZZ.jpg
3 http://images.amazon.com/images/P/0060973129.01.LZZZZZZZ.jpg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the columns needed</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(books)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ISBN"                "Book.Title"          "Book.Author"        
[4] "Year.Of.Publication" "Publisher"           "Image.URL.S"        
[7] "Image.URL.M"         "Image.URL.L"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> books[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(books)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ISBN"                "Book.Title"          "Book.Author"        
[4] "Year.Of.Publication" "Publisher"           "Image.URL.S"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename the colnames</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> books <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">"title"</span> <span class="ot">=</span> <span class="st">"Book.Title"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"author"</span> <span class="ot">=</span> <span class="st">"Book.Author"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"year"</span> <span class="ot">=</span> <span class="st">"Year.Of.Publication"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"publisher"</span> <span class="ot">=</span> <span class="st">"Publisher"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"image_url"</span> <span class="ot">=</span> <span class="st">"Image.URL.S"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(books, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        ISBN                title               author year
1 0195153448  Classical Mythology   Mark P. O. Morford 2002
2 0002005018         Clara Callan Richard Bruce Wright 2001
3 0060973129 Decision in Normandy         Carlo D'Este 1991
                publisher
1 Oxford University Press
2   HarperFlamingo Canada
3         HarperPerennial
                                                     image_url
1 http://images.amazon.com/images/P/0195153448.01.THUMBZZZ.jpg
2 http://images.amazon.com/images/P/0002005018.01.THUMBZZZ.jpg
3 http://images.amazon.com/images/P/0060973129.01.THUMBZZZ.jpg</code></pre>
</div>
</div>
<p>In the books dataset, we will also removed the the image URL for the small and large images, and only kept medium.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Original data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ratings, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  User.ID       ISBN Book.Rating
1  276725 034545104X           0
2  276726 0155061224           5
3  276727 0446520802           0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ratings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "User.ID"     "ISBN"        "Book.Rating"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename the colnames</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> ratings <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="st">"user_id"</span> <span class="ot">=</span> <span class="st">"User.ID"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"rating"</span> <span class="ot">=</span> <span class="st">"Book.Rating"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ratings, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  user_id       ISBN rating
1  276725 034545104X      0
2  276726 0155061224      5
3  276727 0446520802      0</code></pre>
</div>
</div>
</section>
<section id="explore-the-total-number-of-rating-by-users" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-total-number-of-rating-by-users">Explore the total number of rating by users</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ratings_count <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(ratings<span class="sc">$</span>user_id))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ratings_count) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"user_id"</span>, <span class="st">"count"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Sort</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>top_5 <span class="ot">&lt;-</span> <span class="fu">head</span>(ratings_count[<span class="fu">order</span>(<span class="sc">-</span>ratings_count<span class="sc">$</span>count), ], <span class="dv">5</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>bottom_5 <span class="ot">&lt;-</span> <span class="fu">head</span>(ratings_count[<span class="fu">order</span>(ratings_count<span class="sc">$</span>count), ], <span class="dv">5</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the results</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(top_5, bottom_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      user_id count
4214    11676 13602
74816  198711  7550
58114  153662  6109
37357   98391  5891
13577   35859  5850
1           2     1
2           7     1
6          12     1
10         19     1
11         20     1</code></pre>
</div>
</div>
<p>The top book rater user 11676 has rated 13602 books, I was interested to know the age of this person to estimate roughly how many books they read a year, but their age is NA. We can say this person is a bookworm or they just rate books for a hobby. There are also quite a number of users who have only rated one book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ratings_count<span class="sc">$</span>count, <span class="at">main =</span> <span class="st">"Histogram of the number of ratings by user"</span>, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of ratings"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The histogram for the number of ratings is skewed to the right with many users having rated less than 200 books, however there are uses who have rated way more than 200 books too.</p>
</section>
<section id="filter-out-the-ratings" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-the-ratings">Filter out the ratings</h3>
<p>For statistical significance of the model, we will keep only the users who have rated 200 or more books.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Store the user_ids of all the users who have rated 200 or more books</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>common_users <span class="ot">&lt;-</span> (ratings_count<span class="sc">$</span>user_id[ratings_count<span class="sc">$</span>count<span class="sc">&gt;=</span><span class="dv">200</span>]) </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep these users in a df, </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>users_200 <span class="ot">&lt;-</span> ratings[ratings<span class="sc">$</span>user_id<span class="sc">%in%</span>common_users,] <span class="co">#3 var: user_id, ISBN, rating</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(users_200<span class="sc">$</span>user_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(users_200,<span class="dv">100</span>)[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">3</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     user_id       ISBN rating
1537  277427 0345362632      0
1543  277427 0345412214      0
1492  277427 0140390715      7</code></pre>
</div>
</div>
<p>The user_200 data frame contains 899 unique user_ids, but total observations is 527 556. This is expected since each user in this data frame has rated more than 200 books.</p>
<p>Now from the df with more than <code>users_200</code>, we also want to only keep the books that have a lot (more than 50) of ratings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Count the ratings each book receives</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>book_ratings_count <span class="ot">&lt;-</span> users_200 <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ISBN) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_ratings =</span> <span class="fu">n</span>())</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Store the ISBNs of the books with 50 ratings and more</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>common_books <span class="ot">&lt;-</span> (book_ratings_count<span class="sc">$</span>ISBN[book_ratings_count<span class="sc">$</span>total_ratings<span class="sc">&gt;=</span><span class="dv">50</span>])</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#create dataframe that's a subset of the users who have rated 200 books and more. </span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>users200_books50 <span class="ot">&lt;-</span> users_200[users_200<span class="sc">$</span>ISBN<span class="sc">%in%</span>common_books,] <span class="co"># 3 var: user_id, ISBN, rating</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co">#To get the title of the book</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>users200_books50 <span class="ot">&lt;-</span> <span class="fu">merge</span>(users200_books50, books[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="at">by =</span> <span class="st">"ISBN"</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">#To get the total number of rating for a book</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>users200_books50 <span class="ot">&lt;-</span> users200_books50 <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ISBN) <span class="sc">%&gt;%</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_ratings =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(users200_books50, <span class="dv">10000</span>)[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,<span class="dv">3</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  ISBN       user_id rating title                                  total_ratings
  &lt;chr&gt;        &lt;int&gt;  &lt;int&gt; &lt;chr&gt;                                          &lt;int&gt;
1 0060921145   88733      0 Animal Dreams                                     58
2 0060392452  164323      8 Stupid White Men ...and Other Sorry E…            78
3 0060938455    6251      0 Fast Food Nation: The Dark Side of th…            89</code></pre>
</div>
</div>
<p>The rating is the rating user <span class="math inline">\(\boldsymbol x\)</span>, given by <code>user_id</code>, gave a particular book given by <code>ISBN</code> and <code>title</code>. The total_ratings is the total number of ratings the book got.</p>
</section>
<section id="filter-out-users-that-are-not-in-canada" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-users-that-are-not-in-canada">Filter out users that are not in Canada</h3>
<p>To make our recommender system specific, we will only focus on the users in Canada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To get location of the user</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>users200_books50 <span class="ot">&lt;-</span> <span class="fu">merge</span>(users200_books50, users[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="at">by =</span> <span class="st">"user_id"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Search in location for canada and grep these obsercatons</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>usersCA_final <span class="ot">&lt;-</span> users200_books50[<span class="fu">grepl</span>(<span class="st">"canada"</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                                        users200_books50<span class="sc">$</span>location, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(usersCA_final<span class="sc">$</span>user_id))  <span class="co"># 87 unique users</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(usersCA_final<span class="sc">$</span>ISBN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 521</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#keep only the columns we will need to analysis</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> usersCA_final[,<span class="fu">c</span>(<span class="st">"user_id"</span>, <span class="st">"ISBN"</span>, <span class="st">"rating"</span>, <span class="st">"title"</span> , <span class="st">"total_ratings"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After filtering for users in Canada, we were left with 87 unique users, and 521 unique books. This is the dataset we will use for building our model.</p>
</section>
</section>
</section>
<section id="model-building" class="level1">
<h1>Model Building</h1>
<section id="reshape-data" class="level3">
<h3 class="anchored" data-anchor-id="reshape-data">Reshape data</h3>
<p>A pre-requisite for building user based and item collaborative filtering models is to have the data in a matrix form. So we formatted our data into a wide format then matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(user_id,title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare data for pivoting</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>pre_pivot <span class="ot">&lt;-</span> final_data[, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">5</span>)]</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data to wide format, ensuring aggregation is by user_id</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>final_data_pivot <span class="ot">&lt;-</span> pre_pivot <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> title,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> rating)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the other columns(ISBN, total_ratings)</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">#final_data_pivot &lt;- final_data_pivot[,c(-2,-3)]</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>user_ids <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unlist</span>(final_data_pivot[,<span class="dv">1</span>]))</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to matrix form</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>final_data_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(final_data_pivot[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(final_data_matrix) <span class="ot">&lt;-</span> user_ids</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and test sets (80/20 split)</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>test_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(final_data_matrix), <span class="at">size =</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">nrow</span>(final_data_matrix))</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>train_data_matrix <span class="ot">&lt;-</span> final_data_matrix[<span class="sc">-</span>test_indices, ]</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>test_data_matrix <span class="ot">&lt;-</span> final_data_matrix[test_indices, ]</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="co"># save as csv for later Excel demo</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(final_data_matrix, "data/ratings_for_excel_example.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="user-based-collaborative-filtering" class="level2">
<h2 class="anchored" data-anchor-id="user-based-collaborative-filtering">User Based Collaborative Filtering</h2>
<section id="similarity-matrix" class="level3">
<h3 class="anchored" data-anchor-id="similarity-matrix">Similarity Matrix</h3>
<p>To get started with the user-based methods, we computed the user similarity matrix. This matrix is constructed using the cosine method: <span class="math display">\[cos(\theta) = \frac{\boldsymbol x \cdot \boldsymbol y}{||\boldsymbol x|| \ ||\boldsymbol y||} = \frac{\sum_{i=1}^{n}x_iy_i}{\sqrt{\sum_{i=1}^{n}x^2_i} \sqrt{\sum_{i=1}^{n}y^2_i}}\]</span> .</p>
<p>The dimensions is n x n, where n is the number of users. The values indicate how similar two users are, based on their rating of the books they have read.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the user similarity matrix</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>similarity_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">simil</span>(train_data_matrix, <span class="at">method =</span> <span class="st">"cosine"</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View a sample of the similarity matrix</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>similarity_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      6242 16966 23288 26583 27617
6242    NA     0    NA     1     1
16966    0    NA     1    NA     1
23288   NA     1    NA    NA    NA
26583    1    NA    NA    NA    NA
27617    1     1    NA    NA    NA</code></pre>
</div>
</div>
</section>
<section id="prediction-matrix" class="level3">
<h3 class="anchored" data-anchor-id="prediction-matrix">Prediction Matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to predict ratings based on user-based collaborative filtering</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>predict_ratings_ubcf <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, similarity_matrix, rating_matrix, <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the top-k similar users for the given user</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  user_similarities <span class="ot">&lt;-</span> similarity_matrix[user_id,]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  top_k_users <span class="ot">&lt;-</span> <span class="fu">order</span>(user_similarities, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict the rating for each book by taking a weighted average of the ratings</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  pred_ratings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(rating_matrix))</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (book <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(rating_matrix)) {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    ratings_by_similar_users <span class="ot">&lt;-</span> rating_matrix[top_k_users, book]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    similarities <span class="ot">&lt;-</span> user_similarities[top_k_users]</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only use users who have rated the book</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    non_zero_ratings <span class="ot">&lt;-</span> ratings_by_similar_users <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(non_zero_ratings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>      pred_ratings[book] <span class="ot">&lt;-</span> <span class="fu">sum</span>(similarities[non_zero_ratings] <span class="sc">*</span> ratings_by_similar_users[non_zero_ratings], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sum</span>(similarities[non_zero_ratings], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pred_ratings)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-ratings-for-a-particular-user" class="level3">
<h3 class="anchored" data-anchor-id="predicted-ratings-for-a-particular-user">Predicted ratings for a particular user</h3>
<p>Using the <code>predict_ratings_ubcf</code> function, we have calculate an example of the rating user “6242” would give all the book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the actual ratings for user 6242</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>actual_ratings_user_6242 <span class="ot">&lt;-</span> final_data_matrix[<span class="dv">1</span>,]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>pred_ratings_user_6242 <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ubcf</span>(<span class="st">"6242"</span>, similarity_matrix, final_data_matrix)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the predicted and actual ratings side by side</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Book =</span> <span class="fu">colnames</span>(final_data_matrix), </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">Actual_Rating =</span> actual_ratings_user_6242, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">Predicted_Rating =</span> pred_ratings_user_6242)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View predictions in a datatable</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(t1, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-88fdd2a34d502a66744b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-88fdd2a34d502a66744b">{"x":{"filter":"none","vertical":false,"data":[["Girl, Interrupted","I Know This Much Is True","The Amazing Adventures of Kavalier &amp;amp; Clay","Empire Falls","The Reader","How to Be Good","Five Quarters of the Orange","The Red Tent (Bestselling Backlist)","STONES FROM THE RIVER","Angela's Ashes: A Memoir","The Color of Water: A Black Man's Tribute to His White Mother","The Nanny Diaries: A Novel","Songs in Ordinary Time (Oprah's Book Club (Paperback))","Like Water for Chocolate : A Novel in Monthly Installments with Recipes, Romances, and Home Remedies","Wicked: The Life and Times of the Wicked Witch of the West","The Virgin Suicides","Year of Wonders","Plainsong (Vintage Contemporaries)","Midnight in the Garden of Good and Evil","Beloved (Plume Contemporary Fiction)","Cold Mountain","Bel Canto: A Novel","Snow Falling on Cedars","The Girls' Guide to Hunting and Fishing","Skipping Christmas","Welcome to Temptation","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Congo","The Ugly Duckling","Two for the Dough","The Pelican Brief","Message in a Bottle","The Firm","Sphere","Lucky : A Memoir","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","A Is for Alibi (Kinsey Millhone Mysteries (Paperback))","The Beach House","The Search","Cruel &amp;amp; Unusual (Kay Scarpetta Mysteries (Paperback))","Certain Prey","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Schindler's List","Wild Animus","Tis : A Memoir","Flesh and Blood","A Great Deliverance","Midnight in the Garden of Good and Evil: A Savannah Story","The Gunslinger (The Dark Tower, Book 1)","Anne Frank: The Diary of a Young Girl","Bag of Bones","The Perfect Storm : A True Story of Men Against the Sea","Couplehood","It's Always Something","Dances With Wolves","Guilty as Sin","Interview with the Vampire","To Kill a Mockingbird","E Is for Evidence: A Kinsey Millhone Mystery (Kinsey Millhone Mysteries (Paperback))","J Is for Judgment","Winter Moon","A Wrinkle In Time","Tell No One","Kaleidoscope","At Home in Mitford (The Mitford Years)","H Is for Homicide (Kinsey Millhone Mysteries (Paperback))","The Lovely Bones: A Novel","Fried Green Tomatoes at the Whistle Stop Cafe","G Is for Gumshoe (Kinsey Millhone Mysteries (Paperback))","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Hideaway","Full House (Janet Evanovich's Full Series)","Angels &amp;amp; Demons","Deception Point","Deja Dead","While My Pretty One Sleeps","F Is for Fugitive (Kinsey Millhone Mysteries (Paperback))","The Alienist","Icy Sparks","Beach Music","Daisy Fay and the Miracle Man","A Thin Dark Line (Mysteries &amp;amp; Horror)","Billy Straight : A Novel","The Cereal Murders","The Rescue","A Time to Kill","Evening Class","K Is for Killer (Kinsey Millhone Mysteries (Paperback))","The Copper Beech","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Southern Cross","A Prayer for Owen Meany","Watchers","The Horse Whisperer","She's Come Undone (Oprah's Book Club)","Lightning","A Cry In The Night","Shell Seekers","Big Stone Gap: A Novel (Ballantine Reader's Circle)","The Golden Compass (His Dark Materials, Book 1)","The Pillars of the Earth","The Summerhouse","CAT'S EYE","Bridget Jones's Diary","Like Water for Chocolate: A Novel in Monthly Installments, With Recipes, Romances, and Home Remedies","Fahrenheit 451","SHIPPING NEWS","Anne of Green Gables (Anne of Green Gables Novels (Paperback))","The Joy Luck Club","The Pilot's Wife : A Novel","M Is for Malice","The Runaway Jury","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","N Is for Noose","A Fine Balance","The Killing Game: Only One Can Win...and the Loser Dies","Fine Things","Where the Heart Is (Oprah's Book Club (Paperback))","High Five (A Stephanie Plum Novel)","The Bonesetter's Daughter","River, Cross My Heart","The Crimson Petal and the White","A Map of the World","The Poisonwood Bible: A Novel","Atonement : A Novel","The Five People You Meet in Heaven","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","The Secret Life of Bees","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","The Hundred Secret Senses","Anne of the Island","Life of Pi","The Da Vinci Code","Dude, Where's My Country?","Fall On Your Knees (Oprah #45)","Harry Potter and the Prisoner of Azkaban (Book 3)","Bridget Jones: The Edge of Reason","Charlotte's Web (Trophy Newbery)","Anne of Avonlea (Anne of Green Gables Novels (Paperback))","The God of Small Things","Watership Down","The Great Gatsby","Gerald's Game","Four To Score (A Stephanie Plum Novel)","Dragonfly in Amber","American Gods","Jurassic Park","The Chamber","Pop Goes the Weasel","The Tommyknockers","A Painted House","Sophie's World: A Novel About the History of Philosophy","Invasion","The Brethren","Dawn (Cutler)","Angela's Ashes (MMP) : A Memoir","The Bourne Identity","All I Really Need to Know","Black Notice","False Memory","The Bad Place","The Last Precinct","Insomnia","Confessions of a Shopaholic (Summer Display Opportunity)","Harry Potter and the Chamber of Secrets (Book 2)","Chicken Soup for the Soul (Chicken Soup for the Soul)","1984","Loves Music, Loves to Dance","The Kitchen God's Wife","Chicken Soup for the Woman's Soul (Chicken Soup for the Soul Series (Paper))","Dreamcatcher","The Fellowship of the Ring (The Lord of the Rings, Part 1)","The Dark Half","Needful Things","Cradle and All","Dolores Claiborne","Slaughterhouse Five or the Children's Crusade: A Duty Dance With Death","Seize the Night","Red Storm Rising","It Was on Fire When I Lay Down on It","The Lost World","The Rainmaker","Zen and the Art of Motorcycle Maintenance: An Inquiry into Values","The Tao of Pooh","One for the Money (Stephanie Plum Novels (Paperback))","Divine Secrets of the Ya-Ya Sisterhood: A Novel","The Valley of Horses","One Door Away from Heaven","Lord of the Flies","The Return of the King (The Lord of the Rings, Part 3)","Kiss the Girls","The Next Accident","The Street Lawyer","\\O\\\" Is for Outlaw\"","The King of Torts","Mystic River","P Is for Peril","Ellen Foster","Isle of Dogs","The Giver (21st Century Reference)","The Hours: A Novel","Tears of the Giraffe (No.1 Ladies Detective Agency)","Ender's Game (Ender Wiggins Saga (Paperback))","Disclosure","House of Sand and Fog","Midwives: A Novel","Fortune's Rocks: A Novel","While I Was Gone","The Summons","A Heartbreaking Work of Staggering Genius","Seabiscuit: An American Legend","Under the Tuscan Sun","Night Sins","Morality for Beautiful Girls (No.1 Ladies Detective Agency)","Contact","Neverwhere","The Notebook","Cold Mountain : A Novel","The Last Time They Met : A Novel","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","The Other Boleyn Girl","Ashes to Ashes","Wish You Well","Hot Six : A Stephanie Plum Novel (A Stephanie Plum Novel)","Turtle Moon","Deck the Halls (Holiday Classics)","The Queen of the Damned (Vampire Chronicles (Paperback))","Bridget Jones : The Edge of Reason","Shopaholic Takes Manhattan (Summer Display Opportunity)","The Mists of Avalon","Suzanne's Diary for Nicholas","Back Roads","The Mummy or Ramses the Damned","She's Come Undone (Oprah's Book Club (Paperback))","The Rapture of Canaan","Three To Get Deadly : A Stephanie Plum Novel (A Stephanie Plum Novel)","A Bend in the Road","One True Thing","All That Remains (Kay Scarpetta Mysteries (Paperback))","White Oleander : A Novel","The Angel of Darkness","Pay It Forward","When the Wind Blows","Hornet's Nest","A Walk to Remember","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","The Clan of the Cave Bear (Earth's Children (Paperback))","The Book of Ruth (Oprah's Book Club (Paperback))","The Shipping News : A Novel","Three Junes","Animal Dreams","Holes (Yearling Newbery)","Clear and Present Danger (Jack Ryan Novels)","Black and Blue","Artemis Fowl (Artemis Fowl, Book 1)","To the Nines: A Stephanie Plum Novel","Angus, Thongs and Full-Frontal Snogging: Confessions of Georgia Nicolson","Lake Wobegon days","The Prince of Tides","Lamb : The Gospel According to Biff, Christ's Childhood Pal","Saving Faith","The Stone Diaries","Girl with a Pearl Earring","Here on Earth","What Looks Like Crazy On An Ordinary Day","Chocolat","Slow Waltz in Cedar Bend","The Dogs of Babel (Today Show Book Club #12)","The Honk and Holler Opening Soon","A Wrinkle in Time","Seabiscuit","Seven Habits Of Highly Effective People","I Know This Much Is True (Oprah's Book Club)","The Door to December","I Know Why the Caged Bird Sings","2nd Chance","Dying for Chocolate (Culinary Mysteries (Paperback))","Three Fates","Jewel (Oprah's Book Club)","Secret History","Balzac and the Little Chinese Seamstress : A Novel","Outlander","1st to Die: A Novel","Me Talk Pretty One Day","Body of Evidence (Kay Scarpetta Mysteries (Paperback))","Seven Up (A Stephanie Plum Novel)","The Green Mile","Good Omens","Breath, Eyes, Memory","Truly, Madly Manhattan","Postmortem","White Teeth: A Novel","Good in Bed","Vinegar Hill (Oprah's Book Club (Paperback))","Absolute Power","The Simple Truth","Tribulation Force: The Continuing Drama of Those Left Behind (Left Behind No. 2)","Inner Harbor (Quinn Brothers (Paperback))","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","Into Thin Air : A Personal Account of the Mt. Everest Disaster","The Sweet Potato Queens' Book of Love","The Winner","Hearts In Atlantis","Prodigal Summer: A Novel","A Thousand Acres (Ballantine Reader's Circle)","Unnatural Exposure","Nicolae: The Rise of Antichrist (Left Behind No. 3)","Rising Sun","Drowning Ruth (Oprah's Book Club)","Neuromancer (Remembering Tomorrow)","Big Cherry Holler: A Big Stone Gap Novel (Ballantine Reader's Circle)","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","Love in the Time of Cholera (Penguin Great Books of the 20th Century)","Blessings","Violets Are Blue","Betrayal in Death","Little Altars Everywhere: A Novel","Confessions of an Ugly Stepsister : A Novel","Along Came a Spider (Alex Cross Novels)","Purity in Death","Dance upon the Air (Three Sisters Island Trilogy)","A Child Called \\It\\\": One Child's Courage to Survive\"","The First Wives Club Movie Tie In","I Is for Innocent","Sleepers","The Lost Boy: A Foster Child's Search for the Love of a Family","The Celestine Prophecy (Celestine Prophecy)","Mr. Murder","Silence of the Lambs","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","Rose Madder","The Sum of All Fears (Jack Ryan Novels)","The Villa","Jewels of the Sun (Irish Trilogy)","The Color Purple","Point of Origin","Still Waters","Sisterhood of the Traveling Pants","In Her Shoes : A Novel","White Oleander : A Novel (Oprah's Book Club)","Circle of Friends","The Bridges of Madison County","The Bonfire of the Vanities","Wanderlust","Scarlet Feather","Degree of Guilt","Men Are from Mars, Women Are from Venus: A Practical Guide for Improving Communication and Getting What You Want in Your Relationships","Face the Fire (Three Sisters Island Trilogy)","Without Remorse","Zoya","Secrets","Jewel","The Tale of the Body Thief (Vampire Chronicles (Paperback))","The Vampire Lestat (Vampire Chronicles, Book II)","Roses Are Red (Alex Cross Novels)","The Girl Who Loved Tom Gordon","The Hot Zone","Let Me Call You Sweetheart","Tara Road","Pretend You Don't See Her","On the Street Where You Live","Carolina Moon","Daddy's Little Girl","The Cider House Rules","I'll Be Seeing You","Timeline","The Body Farm","And Then You Die","Where the Red Fern Grows","We'll Meet Again","Remember Me","From Potter's Field","Jack &amp;amp; Jill (Alex Cross Novels)","Hide &amp;amp; Seek","Stanislaski Brothers (Silhouette Promo)","Key of Light (Key Trilogy (Paperback))","Night Whispers","A Case of Need","Red Dragon","Airframe","Presumed Innocent","Long After Midnight","Daddy","Weep No More My Lady","The Clinic (Alex Delaware Novels (Paperback))","The Plains of Passage (Earth's Children (Paperback))","Executive Orders (Jack Ryan Novels)","The Andromeda Strain","The Handmaid's Tale","We Were the Mulvaneys","Night","The Witching Hour (Lives of the Mayfair Witches)","Dark Paradise","The General's Daughter","The Blue Nowhere : A Novel","Shopaholic Ties the Knot","Middlesex: A Novel","Song of Solomon (Oprah's Book Club (Paperback))","The No. 1 Ladies' Detective Agency (Today Show Book Club #8)","Blood Work","Hearts in Atlantis","Final Target","How to Make an American Quilt","Fast Food Nation: The Dark Side of the All-American Meal","Into the Wild","Tell Me Lies (Tell Me Lies)","The Weight of Water : A Novel Tag: Author of Resistance and Strange Fits of Passion","Welcome to the World, Baby Girl!","The Deep End of the Ocean","The Catcher in the Rye","The Princess Bride: S Morgenstern's Classic Tale of True Love and High Adventure","Harry Potter and the Goblet of Fire (Book 4)","All the Pretty Horses (The Border Trilogy, Vol 1)","Hannibal","The Client","Fear Nothing","The Idiot Girls' Action Adventure Club","Breathing Lessons","Moonlight Becomes You","Waiting to Exhale","What to Expect When You're Expecting (Revised Edition)","Wifey","Harry Potter and the Order of the Phoenix (Book 5)","The Thorn Birds","Before I Say Good-Bye","Heaven and Earth (Three Sisters Island Trilogy)","Fatal Cure","The Reef","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","Table For Two","Irish Hearts","Girl in Hyacinth Blue","Icebound","The Bachelor (Warner Books Contemporary Romance)","FORREST GUMP (Movie Tie in)","Nickel and Dimed: On (Not) Getting By in America","Portrait in Death","A Civil Action","The English Patient","The Reptile Room (A Series of Unfortunate Events, Book 2)","Dust to Dust","The Bean Trees","The Bad Beginning (A Series of Unfortunate Events, Book 1)","Debt of Honor (Jack Ryan Novels)","4 Blondes","ANGELA'S ASHES","Faking It","Riptide","Chosen Prey","Touching Evil","Engaging The Enemy","Montana Sky","Lucky Man: A Memoir","A Lesson Before Dying (Vintage Contemporaries (Paperback))","Midnight Bayou","The Surgeon","Summer Sisters","The Cardinal of the Kremlin (Jack Ryan Novels)","Macgregor Brides (Macgregors)","Whirlwind (Tyler, Book 1)","My Gal Sunday","Nerd in Shining Armor","Sanctuary","The Genesis Code","Full Tilt (Janet Evanovich's Full Series)","One for the Money (A Stephanie Plum Novel)","Cause of Death","The Loop","Misery","L Is for Lawless","The Smoke Jumper","A Virtuous Woman (Oprah's Book Club (Paperback))","The House of the Spirits","Possession : A Romance","Rules of Prey","The Return Journey","Miss Julia Speaks Her Mind : A Novel","Saint Maybe","Forever... : A Novel of Good and Evil, Love and Hope","The Testament","The Partner","River's End","The Saving Graces: A Novel","That Camden Summer","Macgregor Grooms (Macgregors)","Cat &amp;amp; Mouse (Alex Cross Novels)","The Robber Bride","The Hunt for Red October","Monster : A Novel (Alex Delaware Novels (Paperback))","The Murder Book","Left Behind: A Novel of the Earth's Last Days (Left Behind No. 1)","The Lottery Winner : Alvirah And Willy Stories","Heart of the Sea (Irish Trilogy)","Tears of the Moon (Irish Trilogy)","The Burden of Proof","Crazy for You","The Glass Lake","You Belong To Me","Rising Tides","All Around the Town","Sea Swept (Quinn Brothers (Paperback))","The Mulberry Tree","Patriot Games (Jack Ryan Novels)","Key of Knowledge (Key Trilogy (Paperback))","The Hobbit : The Enchanting Prelude to The Lord of the Rings","Call of the Wild","Echoes","Summer Pleasures","Sick Puppy","The Devil Wears Prada : A Novel","Fast Women","Cry Wolf"],[5,0,6,7,8,6,6,7,8,8,7,5,0,7,7,5,7,5,5,5,8,7,8,5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[0,8,0,0,8,7,6,8,8,10,0,5,0,0,0,0,0,0,8,1,0,0,0,0,0,0,8,0,0,0,6.584778910811773,0,9,0,0,8,8,0,0,0,0,0,10,0,8.652959523228963,0,0,0,10,9.686680444136599,0,0,8,10,0,7,5,10,8,8,0,7,0,0,7,8,9,0,8,6,0,0,9,0,5,0,8,4,0,5,7,0,0,0,0,9,8,8,0,0,0,10,0,5,8,0,0,10,8,0,0,0,0,10,0,0,0,0,5,0,8,0,8,0,0,0,0,8,8,0,0,0,0,0,0,0,8,0,10,0,0,5,8,10,0,0,0,0,6,0,8,0,0,8,0,0,7,0,2,0,8,0,0,0,0,8,0,9,0,0,0,0,9,6.942750590218061,8,7,0,0,0,5.898026984514026,0,0,5,0,7,0,0,0,0,0,0,7,0,0,0,10,0,0,0,0,0,0,0,8,6,0,8,0,0,0,8,0,0,8,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,5,8,0,0,0,8,7,0,0,0,0,6.345953224315807,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,8,0,0,9,0,0,0,0,0,8,9,0,0,0,0,0,8,0,0,0,0,0,0,8,0,7,0,0,0,0,0,10,0,0,0,0,0,7,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,7,8,0,10,0,0,0,7,0,0,8,0,0,0,0,0,0,5,0,0,7,9,0,0,8,7,7,0,10,0,0,7.522858615080287,0,7,6,0,0,0,0,0,0,0,0,6,0,7,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,5,0,0,0,0,0,0,0,7,0,0,6.471375295109031,0,0,8,0,0,0,6,9,0,0,8,7,0,8,0,6,0,0,0,0,0,10,6,0,7.131494394021993,5,4,10,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,8,8,0,0,0,0,0,7,0,0,0,0,0,7,0,6,0,0,0,0,0,0,0,0,7,8,0,0,0,0,0,0,7,0,0,6,0,0,10,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Book<\/th>\n      <th>Actual_Rating<\/th>\n      <th>Predicted_Rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Book","targets":0},{"name":"Actual_Rating","targets":1},{"name":"Predicted_Rating","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="get-top-5-recommendations" class="level3">
<h3 class="anchored" data-anchor-id="get-top-5-recommendations">Get top 5 recommendations</h3>
<p>We were also interested to find out what are the top 5 books to recommend to this user, so we cnstructed a <code>get_recommendations</code> function to output these book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get book recommendations for a given user</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>get_recommendations <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, similarity_matrix, rating_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">num_recommendations =</span> <span class="dv">5</span>) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get predicted ratings for the user</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  pred_ratings <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ubcf</span>(user_id, similarity_matrix, rating_matrix, k)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the actual ratings for the user</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  actual_ratings <span class="ot">&lt;-</span> rating_matrix[user_id,]</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out books that the user has already rated (we only recommend books the user hasn't rated)</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  unrated_books <span class="ot">&lt;-</span> <span class="fu">which</span>(actual_ratings <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(actual_ratings))</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort the predicted ratings for the unrated books in descending order</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  recommended_books <span class="ot">&lt;-</span> <span class="fu">order</span>(pred_ratings[unrated_books], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the top 'num_recommendations' books</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  top_recommendations <span class="ot">&lt;-</span> unrated_books[recommended_books[<span class="dv">1</span><span class="sc">:</span>num_recommendations]]</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the recommended book names and predicted ratings</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Book =</span> <span class="fu">colnames</span>(rating_matrix)[top_recommendations],</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">Predicted_Rating =</span> pred_ratings[top_recommendations])</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Get 5 recommendations for user 6242 using UBCF with k=10</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>recommendations_user_6242 <span class="ot">&lt;-</span> <span class="fu">get_recommendations</span>(<span class="st">"6242"</span>, similarity_matrix, final_data_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">num_recommendations =</span> <span class="dv">5</span>)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(recommendations_user_6242, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8e1fe96c0688a849169a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e1fe96c0688a849169a">{"x":{"filter":"none","vertical":false,"data":[["Schindler's List","The Gunslinger (The Dark Tower, Book 1)","It's Always Something","To Kill a Mockingbird","A Prayer for Owen Meany"],[10,10,10,10,10]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Book<\/th>\n      <th>Predicted_Rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"name":"Book","targets":0},{"name":"Predicted_Rating","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>To verify that the model and the functions were actually working, we also got recommendations for a different user.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Get 5 recommendations for user 41841 using UBCF with k=10</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>recommendations_user_41841 <span class="ot">&lt;-</span> <span class="fu">get_recommendations</span>(<span class="st">"41841"</span>, similarity_matrix, final_data_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">num_recommendations =</span> <span class="dv">5</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(recommendations_user_41841)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-bb3486349adfa5d821dc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bb3486349adfa5d821dc">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["One True Thing","Sphere","Like Water for Chocolate: A Novel in Monthly Installments, With Recipes, Romances, and Home Remedies","Anne of the Island","Anne of Avonlea (Anne of Green Gables Novels (Paperback))"],[10,9,9,9,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Book<\/th>\n      <th>Predicted_Rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Book","targets":1},{"name":"Predicted_Rating","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This user indeed got a different set of books.</p>
</section>
</section>
<section id="item-based-collaborative-filtering" class="level2">
<h2 class="anchored" data-anchor-id="item-based-collaborative-filtering">Item-Based Collaborative Filtering</h2>
<p>For item based we also followed the same logic as in the user based model. We are still using the same data.</p>
<section id="similarity-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="similarity-matrix-1">Similarity Matrix</h3>
<p>The similarity matrix here shows similarity between the books. So which books are commonly read together and recieved similar ratings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the item similarity matrix</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>item_similarity_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">simil</span>(<span class="fu">t</span>(final_data_matrix), <span class="at">method =</span> <span class="st">"cosine"</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View a sample of the item similarity matrix</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">#item_similarity_matrix[1:5, 1:5]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prediction-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="prediction-matrix-1">Prediction Matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to predict ratings based on item-based collaborative filtering</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>predict_ratings_ibcf <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, item_similarity_matrix, rating_matrix, <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the user's ratings</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  user_ratings <span class="ot">&lt;-</span> rating_matrix[user_id,]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict the rating for each book</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  pred_ratings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(rating_matrix))</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (book <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(rating_matrix)) {</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    similarities <span class="ot">&lt;-</span> item_similarity_matrix[book,]</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the books that the user has rated, ignoring NAs</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    rated_books <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(user_ratings) <span class="sc">&amp;</span> user_ratings <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only proceed if there are rated books</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(rated_books, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>      pred_ratings[book] <span class="ot">&lt;-</span> <span class="fu">sum</span>(similarities[rated_books] <span class="sc">*</span> user_ratings[rated_books], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sum</span>(similarities[rated_books], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>      pred_ratings[book] <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Set to NA if no rated books are found</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pred_ratings)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-ratings-for-a-particular-user-1" class="level3">
<h3 class="anchored" data-anchor-id="predicted-ratings-for-a-particular-user-1">Predicted ratings for a particular user</h3>
<p>Using the <code>predict_ratings_ibcf</code> function, we have calculate an example of the rating user “6242” would give all the book. We will compare these with the ratings the user-based CF model gave.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the actual ratings for user 6242</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>actual_ratings_user_6242_ibcf <span class="ot">&lt;-</span> final_data_matrix[<span class="dv">1</span>,]</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>pred_ratings_user_6242_ibcf <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ibcf</span>(<span class="st">"6242"</span>, item_similarity_matrix, final_data_matrix)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the predicted and actual ratings side by side</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Book =</span> <span class="fu">colnames</span>(final_data_matrix), </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">Actual_Rating =</span> actual_ratings_user_6242_ibcf, </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">Predicted_Rating =</span> <span class="fu">round</span>(pred_ratings_user_6242_ibcf, <span class="dv">2</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(t2, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-44474b3e8cd160f85a98" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-44474b3e8cd160f85a98">{"x":{"filter":"none","vertical":false,"data":[["Girl, Interrupted","I Know This Much Is True","The Amazing Adventures of Kavalier &amp;amp; Clay","Empire Falls","The Reader","How to Be Good","Five Quarters of the Orange","The Red Tent (Bestselling Backlist)","STONES FROM THE RIVER","Angela's Ashes: A Memoir","The Color of Water: A Black Man's Tribute to His White Mother","The Nanny Diaries: A Novel","Songs in Ordinary Time (Oprah's Book Club (Paperback))","Like Water for Chocolate : A Novel in Monthly Installments with Recipes, Romances, and Home Remedies","Wicked: The Life and Times of the Wicked Witch of the West","The Virgin Suicides","Year of Wonders","Plainsong (Vintage Contemporaries)","Midnight in the Garden of Good and Evil","Beloved (Plume Contemporary Fiction)","Cold Mountain","Bel Canto: A Novel","Snow Falling on Cedars","The Girls' Guide to Hunting and Fishing","Skipping Christmas","Welcome to Temptation","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Congo","The Ugly Duckling","Two for the Dough","The Pelican Brief","Message in a Bottle","The Firm","Sphere","Lucky : A Memoir","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","A Is for Alibi (Kinsey Millhone Mysteries (Paperback))","The Beach House","The Search","Cruel &amp;amp; Unusual (Kay Scarpetta Mysteries (Paperback))","Certain Prey","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Schindler's List","Wild Animus","Tis : A Memoir","Flesh and Blood","A Great Deliverance","Midnight in the Garden of Good and Evil: A Savannah Story","The Gunslinger (The Dark Tower, Book 1)","Anne Frank: The Diary of a Young Girl","Bag of Bones","The Perfect Storm : A True Story of Men Against the Sea","Couplehood","It's Always Something","Dances With Wolves","Guilty as Sin","Interview with the Vampire","To Kill a Mockingbird","E Is for Evidence: A Kinsey Millhone Mystery (Kinsey Millhone Mysteries (Paperback))","J Is for Judgment","Winter Moon","A Wrinkle In Time","Tell No One","Kaleidoscope","At Home in Mitford (The Mitford Years)","H Is for Homicide (Kinsey Millhone Mysteries (Paperback))","The Lovely Bones: A Novel","Fried Green Tomatoes at the Whistle Stop Cafe","G Is for Gumshoe (Kinsey Millhone Mysteries (Paperback))","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Hideaway","Full House (Janet Evanovich's Full Series)","Angels &amp;amp; Demons","Deception Point","Deja Dead","While My Pretty One Sleeps","F Is for Fugitive (Kinsey Millhone Mysteries (Paperback))","The Alienist","Icy Sparks","Beach Music","Daisy Fay and the Miracle Man","A Thin Dark Line (Mysteries &amp;amp; Horror)","Billy Straight : A Novel","The Cereal Murders","The Rescue","A Time to Kill","Evening Class","K Is for Killer (Kinsey Millhone Mysteries (Paperback))","The Copper Beech","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Southern Cross","A Prayer for Owen Meany","Watchers","The Horse Whisperer","She's Come Undone (Oprah's Book Club)","Lightning","A Cry In The Night","Shell Seekers","Big Stone Gap: A Novel (Ballantine Reader's Circle)","The Golden Compass (His Dark Materials, Book 1)","The Pillars of the Earth","The Summerhouse","CAT'S EYE","Bridget Jones's Diary","Like Water for Chocolate: A Novel in Monthly Installments, With Recipes, Romances, and Home Remedies","Fahrenheit 451","SHIPPING NEWS","Anne of Green Gables (Anne of Green Gables Novels (Paperback))","The Joy Luck Club","The Pilot's Wife : A Novel","M Is for Malice","The Runaway Jury","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","N Is for Noose","A Fine Balance","The Killing Game: Only One Can Win...and the Loser Dies","Fine Things","Where the Heart Is (Oprah's Book Club (Paperback))","High Five (A Stephanie Plum Novel)","The Bonesetter's Daughter","River, Cross My Heart","The Crimson Petal and the White","A Map of the World","The Poisonwood Bible: A Novel","Atonement : A Novel","The Five People You Meet in Heaven","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","The Secret Life of Bees","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","The Hundred Secret Senses","Anne of the Island","Life of Pi","The Da Vinci Code","Dude, Where's My Country?","Fall On Your Knees (Oprah #45)","Harry Potter and the Prisoner of Azkaban (Book 3)","Bridget Jones: The Edge of Reason","Charlotte's Web (Trophy Newbery)","Anne of Avonlea (Anne of Green Gables Novels (Paperback))","The God of Small Things","Watership Down","The Great Gatsby","Gerald's Game","Four To Score (A Stephanie Plum Novel)","Dragonfly in Amber","American Gods","Jurassic Park","The Chamber","Pop Goes the Weasel","The Tommyknockers","A Painted House","Sophie's World: A Novel About the History of Philosophy","Invasion","The Brethren","Dawn (Cutler)","Angela's Ashes (MMP) : A Memoir","The Bourne Identity","All I Really Need to Know","Black Notice","False Memory","The Bad Place","The Last Precinct","Insomnia","Confessions of a Shopaholic (Summer Display Opportunity)","Harry Potter and the Chamber of Secrets (Book 2)","Chicken Soup for the Soul (Chicken Soup for the Soul)","1984","Loves Music, Loves to Dance","The Kitchen God's Wife","Chicken Soup for the Woman's Soul (Chicken Soup for the Soul Series (Paper))","Dreamcatcher","The Fellowship of the Ring (The Lord of the Rings, Part 1)","The Dark Half","Needful Things","Cradle and All","Dolores Claiborne","Slaughterhouse Five or the Children's Crusade: A Duty Dance With Death","Seize the Night","Red Storm Rising","It Was on Fire When I Lay Down on It","The Lost World","The Rainmaker","Zen and the Art of Motorcycle Maintenance: An Inquiry into Values","The Tao of Pooh","One for the Money (Stephanie Plum Novels (Paperback))","Divine Secrets of the Ya-Ya Sisterhood: A Novel","The Valley of Horses","One Door Away from Heaven","Lord of the Flies","The Return of the King (The Lord of the Rings, Part 3)","Kiss the Girls","The Next Accident","The Street Lawyer","\\O\\\" Is for Outlaw\"","The King of Torts","Mystic River","P Is for Peril","Ellen Foster","Isle of Dogs","The Giver (21st Century Reference)","The Hours: A Novel","Tears of the Giraffe (No.1 Ladies Detective Agency)","Ender's Game (Ender Wiggins Saga (Paperback))","Disclosure","House of Sand and Fog","Midwives: A Novel","Fortune's Rocks: A Novel","While I Was Gone","The Summons","A Heartbreaking Work of Staggering Genius","Seabiscuit: An American Legend","Under the Tuscan Sun","Night Sins","Morality for Beautiful Girls (No.1 Ladies Detective Agency)","Contact","Neverwhere","The Notebook","Cold Mountain : A Novel","The Last Time They Met : A Novel","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","The Other Boleyn Girl","Ashes to Ashes","Wish You Well","Hot Six : A Stephanie Plum Novel (A Stephanie Plum Novel)","Turtle Moon","Deck the Halls (Holiday Classics)","The Queen of the Damned (Vampire Chronicles (Paperback))","Bridget Jones : The Edge of Reason","Shopaholic Takes Manhattan (Summer Display Opportunity)","The Mists of Avalon","Suzanne's Diary for Nicholas","Back Roads","The Mummy or Ramses the Damned","She's Come Undone (Oprah's Book Club (Paperback))","The Rapture of Canaan","Three To Get Deadly : A Stephanie Plum Novel (A Stephanie Plum Novel)","A Bend in the Road","One True Thing","All That Remains (Kay Scarpetta Mysteries (Paperback))","White Oleander : A Novel","The Angel of Darkness","Pay It Forward","When the Wind Blows","Hornet's Nest","A Walk to Remember","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","The Clan of the Cave Bear (Earth's Children (Paperback))","The Book of Ruth (Oprah's Book Club (Paperback))","The Shipping News : A Novel","Three Junes","Animal Dreams","Holes (Yearling Newbery)","Clear and Present Danger (Jack Ryan Novels)","Black and Blue","Artemis Fowl (Artemis Fowl, Book 1)","To the Nines: A Stephanie Plum Novel","Angus, Thongs and Full-Frontal Snogging: Confessions of Georgia Nicolson","Lake Wobegon days","The Prince of Tides","Lamb : The Gospel According to Biff, Christ's Childhood Pal","Saving Faith","The Stone Diaries","Girl with a Pearl Earring","Here on Earth","What Looks Like Crazy On An Ordinary Day","Chocolat","Slow Waltz in Cedar Bend","The Dogs of Babel (Today Show Book Club #12)","The Honk and Holler Opening Soon","A Wrinkle in Time","Seabiscuit","Seven Habits Of Highly Effective People","I Know This Much Is True (Oprah's Book Club)","The Door to December","I Know Why the Caged Bird Sings","2nd Chance","Dying for Chocolate (Culinary Mysteries (Paperback))","Three Fates","Jewel (Oprah's Book Club)","Secret History","Balzac and the Little Chinese Seamstress : A Novel","Outlander","1st to Die: A Novel","Me Talk Pretty One Day","Body of Evidence (Kay Scarpetta Mysteries (Paperback))","Seven Up (A Stephanie Plum Novel)","The Green Mile","Good Omens","Breath, Eyes, Memory","Truly, Madly Manhattan","Postmortem","White Teeth: A Novel","Good in Bed","Vinegar Hill (Oprah's Book Club (Paperback))","Absolute Power","The Simple Truth","Tribulation Force: The Continuing Drama of Those Left Behind (Left Behind No. 2)","Inner Harbor (Quinn Brothers (Paperback))","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","Into Thin Air : A Personal Account of the Mt. Everest Disaster","The Sweet Potato Queens' Book of Love","The Winner","Hearts In Atlantis","Prodigal Summer: A Novel","A Thousand Acres (Ballantine Reader's Circle)","Unnatural Exposure","Nicolae: The Rise of Antichrist (Left Behind No. 3)","Rising Sun","Drowning Ruth (Oprah's Book Club)","Neuromancer (Remembering Tomorrow)","Big Cherry Holler: A Big Stone Gap Novel (Ballantine Reader's Circle)","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","Love in the Time of Cholera (Penguin Great Books of the 20th Century)","Blessings","Violets Are Blue","Betrayal in Death","Little Altars Everywhere: A Novel","Confessions of an Ugly Stepsister : A Novel","Along Came a Spider (Alex Cross Novels)","Purity in Death","Dance upon the Air (Three Sisters Island Trilogy)","A Child Called \\It\\\": One Child's Courage to Survive\"","The First Wives Club Movie Tie In","I Is for Innocent","Sleepers","The Lost Boy: A Foster Child's Search for the Love of a Family","The Celestine Prophecy (Celestine Prophecy)","Mr. Murder","Silence of the Lambs","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","Rose Madder","The Sum of All Fears (Jack Ryan Novels)","The Villa","Jewels of the Sun (Irish Trilogy)","The Color Purple","Point of Origin","Still Waters","Sisterhood of the Traveling Pants","In Her Shoes : A Novel","White Oleander : A Novel (Oprah's Book Club)","Circle of Friends","The Bridges of Madison County","The Bonfire of the Vanities","Wanderlust","Scarlet Feather","Degree of Guilt","Men Are from Mars, Women Are from Venus: A Practical Guide for Improving Communication and Getting What You Want in Your Relationships","Face the Fire (Three Sisters Island Trilogy)","Without Remorse","Zoya","Secrets","Jewel","The Tale of the Body Thief (Vampire Chronicles (Paperback))","The Vampire Lestat (Vampire Chronicles, Book II)","Roses Are Red (Alex Cross Novels)","The Girl Who Loved Tom Gordon","The Hot Zone","Let Me Call You Sweetheart","Tara Road","Pretend You Don't See Her","On the Street Where You Live","Carolina Moon","Daddy's Little Girl","The Cider House Rules","I'll Be Seeing You","Timeline","The Body Farm","And Then You Die","Where the Red Fern Grows","We'll Meet Again","Remember Me","From Potter's Field","Jack &amp;amp; Jill (Alex Cross Novels)","Hide &amp;amp; Seek","Stanislaski Brothers (Silhouette Promo)","Key of Light (Key Trilogy (Paperback))","Night Whispers","A Case of Need","Red Dragon","Airframe","Presumed Innocent","Long After Midnight","Daddy","Weep No More My Lady","The Clinic (Alex Delaware Novels (Paperback))","The Plains of Passage (Earth's Children (Paperback))","Executive Orders (Jack Ryan Novels)","The Andromeda Strain","The Handmaid's Tale","We Were the Mulvaneys","Night","The Witching Hour (Lives of the Mayfair Witches)","Dark Paradise","The General's Daughter","The Blue Nowhere : A Novel","Shopaholic Ties the Knot","Middlesex: A Novel","Song of Solomon (Oprah's Book Club (Paperback))","The No. 1 Ladies' Detective Agency (Today Show Book Club #8)","Blood Work","Hearts in Atlantis","Final Target","How to Make an American Quilt","Fast Food Nation: The Dark Side of the All-American Meal","Into the Wild","Tell Me Lies (Tell Me Lies)","The Weight of Water : A Novel Tag: Author of Resistance and Strange Fits of Passion","Welcome to the World, Baby Girl!","The Deep End of the Ocean","The Catcher in the Rye","The Princess Bride: S Morgenstern's Classic Tale of True Love and High Adventure","Harry Potter and the Goblet of Fire (Book 4)","All the Pretty Horses (The Border Trilogy, Vol 1)","Hannibal","The Client","Fear Nothing","The Idiot Girls' Action Adventure Club","Breathing Lessons","Moonlight Becomes You","Waiting to Exhale","What to Expect When You're Expecting (Revised Edition)","Wifey","Harry Potter and the Order of the Phoenix (Book 5)","The Thorn Birds","Before I Say Good-Bye","Heaven and Earth (Three Sisters Island Trilogy)","Fatal Cure","The Reef","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","Table For Two","Irish Hearts","Girl in Hyacinth Blue","Icebound","The Bachelor (Warner Books Contemporary Romance)","FORREST GUMP (Movie Tie in)","Nickel and Dimed: On (Not) Getting By in America","Portrait in Death","A Civil Action","The English Patient","The Reptile Room (A Series of Unfortunate Events, Book 2)","Dust to Dust","The Bean Trees","The Bad Beginning (A Series of Unfortunate Events, Book 1)","Debt of Honor (Jack Ryan Novels)","4 Blondes","ANGELA'S ASHES","Faking It","Riptide","Chosen Prey","Touching Evil","Engaging The Enemy","Montana Sky","Lucky Man: A Memoir","A Lesson Before Dying (Vintage Contemporaries (Paperback))","Midnight Bayou","The Surgeon","Summer Sisters","The Cardinal of the Kremlin (Jack Ryan Novels)","Macgregor Brides (Macgregors)","Whirlwind (Tyler, Book 1)","My Gal Sunday","Nerd in Shining Armor","Sanctuary","The Genesis Code","Full Tilt (Janet Evanovich's Full Series)","One for the Money (A Stephanie Plum Novel)","Cause of Death","The Loop","Misery","L Is for Lawless","The Smoke Jumper","A Virtuous Woman (Oprah's Book Club (Paperback))","The House of the Spirits","Possession : A Romance","Rules of Prey","The Return Journey","Miss Julia Speaks Her Mind : A Novel","Saint Maybe","Forever... : A Novel of Good and Evil, Love and Hope","The Testament","The Partner","River's End","The Saving Graces: A Novel","That Camden Summer","Macgregor Grooms (Macgregors)","Cat &amp;amp; Mouse (Alex Cross Novels)","The Robber Bride","The Hunt for Red October","Monster : A Novel (Alex Delaware Novels (Paperback))","The Murder Book","Left Behind: A Novel of the Earth's Last Days (Left Behind No. 1)","The Lottery Winner : Alvirah And Willy Stories","Heart of the Sea (Irish Trilogy)","Tears of the Moon (Irish Trilogy)","The Burden of Proof","Crazy for You","The Glass Lake","You Belong To Me","Rising Tides","All Around the Town","Sea Swept (Quinn Brothers (Paperback))","The Mulberry Tree","Patriot Games (Jack Ryan Novels)","Key of Knowledge (Key Trilogy (Paperback))","The Hobbit : The Enchanting Prelude to The Lord of the Rings","Call of the Wild","Echoes","Summer Pleasures","Sick Puppy","The Devil Wears Prada : A Novel","Fast Women","Cry Wolf"],[5,0,6,7,8,6,6,7,8,8,7,5,0,7,7,5,7,5,5,5,8,7,8,5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[6.59,6.3,6.44,6.43,6.3,6.43,6.36,6.57,6.37,6.32,6.43,6.55,7.44,6.37,6.48,6.52,6.48,6.49,6.47,6.53,6.41,6.42,6.26,6.4,6.21,6,6.5,6.57,7,6.22,5.81,6.3,5.6,6.86,6.36,5.88,5.62,6.33,null,6.1,null,6.24,6.67,6.41,6.76,6,6.75,null,6.67,6.41,8,6.6,6.82,6.5,6.5,6.27,7.05,6.83,6.25,6.25,5.86,6.88,6.33,6.67,7.17,6.57,5.68,6,6.34,7,6.25,6.08,6.32,6.25,7.17,6,6.62,5.87,6.13,7.36,6.15,6.83,7,6.45,7,6.22,6.44,6.49,6,6.11,6.45,6.15,5.67,7.06,6.05,5.5,6.67,6.88,7.25,6.75,6.73,6.22,6,6.39,7.14,6.67,6.39,7,6.63,6.01,6.37,6.2,6.2,7,6.75,6.75,6.33,6.22,6.35,6.25,6.73,5.77,6.86,6.61,5.88,6.53,5.65,6.5,6.25,5.71,6.4,5.8,7.5,6.44,6.41,6.75,6,6.36,6.29,6.6,6.56,6,null,6.84,7,6.55,6.38,6.1,6,8,6.45,6.8,6.67,6.75,8,6.47,6,6.42,6.38,5,6,6.4,6.88,6.02,6.33,7,6.67,6.62,5.72,6.5,6.69,6.67,6.33,5,8,5.9,6.4,7,6.67,6,6.75,7.19,6.75,5.65,5.88,5.78,6.87,6,6.88,6.75,6.21,6.31,6.71,6.29,5.95,6.25,5.25,6.8,6.67,6.5,6.33,6.21,7.65,6.16,6.59,6.57,5.5,6.64,7.17,6,6.67,5.45,5.6,6.75,7,6.37,6.15,6.67,7.03,6.42,6.41,6.71,7.29,6.73,6.25,6.5,6.33,6.68,6.29,6.78,6.95,5.67,6.5,6.76,6.2,6,5.86,6.6,6.38,7.42,5.91,7.12,5.8,6.17,6.18,6.28,6.85,5.6,6.14,6.23,6.3,6.32,6.5,6.83,6.57,6.8,6.28,6.5,6.34,6.67,6.5,6.5,6.44,6.54,6.21,6.68,6.7,6.24,6.54,6.6,6.5,6.66,6.77,6.14,6.7,6,6.82,6.18,7.24,6.33,6.15,6,5.71,6.75,6.5,5.75,6.2,6.5,6.11,6.67,6.5,6.44,6,6.5,6.5,5.78,6.5,6.67,6.43,6.5,6.34,7.06,6.67,6.5,5.67,6.33,6.5,7,6.12,7,6.07,6.92,6.66,7.51,6.5,6.33,6,6.36,5.75,6.56,7.18,6.6,6,5.83,7,6.5,6.75,6.5,6.8,6.57,6.33,7.5,6.4,7,6.83,6.86,6.83,7,7,6,6,6.43,6.5,6.5,6.72,6.5,8,7.18,7.5,7.17,6,7.27,7.5,6,6.2,6,6.2,6.2,6.22,5.83,6.8,7.67,6.75,6.82,6.67,6.88,5.98,5,5.86,6.8,5.75,7.2,6.67,7,6.4,5.9,5.86,6.75,7.33,6.73,6.67,7,7.17,6,7.5,7.67,7,7.15,7.09,6.01,6.5,6.17,7.61,8,6.8,6.12,6,6.66,6.15,8,6.18,6.83,6.16,6.68,7.33,5,6.5,6.36,6.86,6.67,6.75,5.75,null,7,6.71,7.25,null,6,5.56,7,6.9,6.61,5.8,6.9,6.62,7.39,null,6.4,5.9,7.43,5.86,6.71,6,6,6,6.93,6.89,6.4,6.89,6.9,6.7,7.5,6.45,7,7.25,6.33,6.67,6.5,6.2,5,7.17,7.51,6.5,6.69,6.22,null,6,6.27,6,6,6.33,6.2,7.67,8,5.5,7,7.5,7.5,6.5,6.33,6.5,6.5,6.5,null,null,6,7,7,6.57,7.33,7.33,7.6,7,7.6,6.4,7.6,6.88,7.2,7,7.5,6.5,8,7,7.5,6.2,6.5,6.75,8,8,6.22,7.67,8,6.25,6.8,8,8,7.5,7,null,7,7,7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Book<\/th>\n      <th>Actual_Rating<\/th>\n      <th>Predicted_Rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Book","targets":0},{"name":"Actual_Rating","targets":1},{"name":"Predicted_Rating","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In comparison to the UB-CF model, this model seems to be giving relatively high ratings, With all the ratings lying close to the mean rating which is 5.</p>
<p>The UB-CF model has most of the predicted ratings lying between 0 and 1 and and very large like 10. The distribution is skewed to the right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t1<span class="sc">$</span>Predicted_Rating, <span class="at">main =</span> <span class="st">"Histogram of the predicted ratings for user_id 6242 using the UB-CF model"</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted rating"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The IB-CF predicted rating are normally distributed around 6.5, with no predicted ratings less than 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t2<span class="sc">$</span>Predicted_Rating, <span class="at">main =</span> <span class="st">"Histogram of the predicted ratings for user_id 6242</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="st">     using the IB-CF model"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted rating"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="get-top-5-recommendations-1" class="level3">
<h3 class="anchored" data-anchor-id="get-top-5-recommendations-1">Get top 5 recommendations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get book recommendations for a given user using IBCF</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>get_recommendations_ibcf <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, item_similarity_matrix, rating_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">num_recommendations =</span> <span class="dv">5</span>) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert user_id to numeric index if necessary</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.character</span>(user_id)) {</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    user_index <span class="ot">&lt;-</span> <span class="fu">match</span>(user_id, <span class="fu">rownames</span>(rating_matrix))  <span class="co"># Find user row number if it's a string</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    user_index <span class="ot">&lt;-</span> user_id  <span class="co"># If already numeric, use as is</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if user_id exists in the matrix</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(user_index)) {</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"User ID not found in the rating matrix."</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get predicted ratings for the user using the predict_ratings_ibcf function</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  pred_ratings <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ibcf</span>(user_index, item_similarity_matrix, rating_matrix, k)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the actual ratings for the user</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  actual_ratings <span class="ot">&lt;-</span> rating_matrix[user_index,]</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out books that the user has already rated (i.e., we only recommend unrated books)</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  unrated_books <span class="ot">&lt;-</span> <span class="fu">which</span>(actual_ratings <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(actual_ratings))</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort the predicted ratings for the unrated books in descending order</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  sorted_unrated_books <span class="ot">&lt;-</span> <span class="fu">order</span>(pred_ratings[unrated_books], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select the top 'num_recommendations' unrated books</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  top_recommendations <span class="ot">&lt;-</span> unrated_books[sorted_unrated_books[<span class="dv">1</span><span class="sc">:</span>num_recommendations]]</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the recommended book names and predicted ratings in a data frame</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  recommended_books <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Book =</span> <span class="fu">colnames</span>(rating_matrix)[top_recommendations],</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicted_Rating =</span> pred_ratings[top_recommendations]</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(recommended_books)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Get 5 recommendations for user 6242 using IBCF with k=10</span></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>recommendations_user_6242_ibcf <span class="ot">&lt;-</span> <span class="fu">get_recommendations_ibcf</span>(<span class="st">"6242"</span>, item_similarity_matrix, final_data_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">num_recommendations =</span> <span class="dv">5</span>)</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="co"># View the recommendations</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(recommendations_user_6242_ibcf, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2514ce28ae593bde0f73" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2514ce28ae593bde0f73">{"x":{"filter":"none","vertical":false,"data":[["Bag of Bones","The Tommyknockers","Dawn (Cutler)","Cradle and All","Men Are from Mars, Women Are from Venus: A Practical Guide for Improving Communication and Getting What You Want in Your Relationships"],[8,8,8,8,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Book<\/th>\n      <th>Predicted_Rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"name":"Book","targets":0},{"name":"Predicted_Rating","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The two models have all different book in the top five recommended books. The types of books by each recommender system also differ, the books by the UB-CF have common themes around emotional depth, personal growth, and relationships. While the book recommended by the IB-CF are all thriller, horror, or science fiction genres, except for ‘Men Are from Mars, Women Are from Venus: A Practical Guide for Improving Communication and Getting What You Want in Your Relationship’, which is more relationship themed.</p>
</section>
</section>
<section id="matrix-factorization" class="level2">
<h2 class="anchored" data-anchor-id="matrix-factorization">Matrix factorization</h2>
<section id="prepare-data-for-recosystem" class="level3">
<h3 class="anchored" data-anchor-id="prepare-data-for-recosystem">Prepare data for recosystem</h3>
<p>In order to use the <em>recosystem</em> we will change the id variables (here <em>user_id</em> and <em>ISBN</em>) to be integers starting at either 0 or 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create df with ISBN, user_id, rating and title</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>mf_data <span class="ot">&lt;-</span> usersCA_final[,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>)]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new integer IDs for users and items</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>user_id <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">user_id =</span> <span class="fu">unique</span>(mf_data<span class="sc">$</span>user_id), <span class="at">new_userId =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">unique</span>(mf_data<span class="sc">$</span>user_id)) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>ISBN <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ISBN =</span> <span class="fu">unique</span>(mf_data<span class="sc">$</span>ISBN), <span class="at">new_ISBN =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">unique</span>(mf_data<span class="sc">$</span>ISBN)) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Join these new IDs back to your dataset</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>mf_data <span class="ot">&lt;-</span> mf_data <span class="sc">|&gt;</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(user_id, <span class="at">by =</span> <span class="st">"user_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ISBN, <span class="at">by =</span> <span class="st">"ISBN"</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the relevant columns with new IDs</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>mf_data <span class="ot">&lt;-</span> mf_data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">user_id =</span> new_userId, <span class="at">ISBN =</span> new_ISBN, rating, title)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For cross validation, we allocate 80% of each user’s ratings to a training dataset, and use the remaining 20% as a test set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets (80% train, 20% test)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> mf_data <span class="sc">|&gt;</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(user_id) <span class="sc">|&gt;</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(mf_data, test_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"user_id"</span>, <span class="st">"ISBN"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then set up the ratings data in the format required by <em>recosystem</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for recosystem</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>reco_train <span class="ot">&lt;-</span> <span class="fu">data_memory</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">user_index =</span> train_data<span class="sc">$</span>user_id,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_index =</span> train_data<span class="sc">$</span>ISBN,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> train_data<span class="sc">$</span>rating</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>reco_test <span class="ot">&lt;-</span> <span class="fu">data_memory</span>(</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">user_index =</span> test_data<span class="sc">$</span>user_id,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_index =</span> test_data<span class="sc">$</span>ISBN,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> test_data<span class="sc">$</span>rating</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="build-model" class="level3">
<h3 class="anchored" data-anchor-id="build-model">Build model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Recosystem model</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">Reco</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now train a single matrix factorization model with specific hyperparameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model with specific hyperparameters</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>rs<span class="sc">$</span><span class="fu">train</span>(reco_train, <span class="at">opts =</span> <span class="fu">list</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dim =</span> <span class="dv">10</span>,          <span class="co"># Number of latent factors</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmf =</span> <span class="cn">TRUE</span>,        <span class="co"># Perform non-negative matrix factorization</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">niter =</span> <span class="dv">50</span>,        <span class="co"># Number of iterations</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>    <span class="co"># Suppress verbose output</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predictions-and-model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="predictions-and-model-evaluation">Predictions and Model evaluation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ratings on the test set</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>MF_pred <span class="ot">&lt;-</span> rs<span class="sc">$</span><span class="fu">predict</span>(reco_test)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RMSE for predictions</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((MF_pred <span class="sc">-</span> test_data<span class="sc">$</span>rating)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Matrix Factorisation RMSE: "</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix Factorisation RMSE:  4.04</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the predictions in the test dataset</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> test_data <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted_rating =</span> <span class="fu">round</span>(MF_pred,<span class="dv">2</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View predictions in a datatable</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(pred_data, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5d05eac75555269eefd0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d05eac75555269eefd0">{"x":{"filter":"none","vertical":false,"data":[[0,0,0,0,1,1,2,3,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,20,20,20,20,20,20,20,20,21,22,22,22,22,22,23,24,24,24,25,25,25,25,25,25,25,25,25,25,25,26,26,27,27,27,27,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,44,44,45,45,45,46,46,46,46,46,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,55,55,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,64,64,64,64,64,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,71,71,71,71,71,71,72,73,73,73,73,74,74,74,74,75,76,76,76,77,77,77,78,78,78,78,79,79,79,80,80,80,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86],[14,18,13,2,32,22,40,9,48,27,49,34,117,35,26,79,64,94,116,112,74,89,69,72,95,124,136,128,130,126,87,85,168,68,154,158,181,69,29,189,190,165,77,182,92,156,195,194,43,48,213,215,195,84,192,203,273,322,31,311,145,253,241,21,230,264,105,69,64,233,57,202,235,242,131,162,299,41,43,285,261,301,128,218,290,269,14,297,254,35,282,39,258,329,330,325,337,32,181,82,144,26,112,216,346,72,27,353,208,308,249,1,340,225,205,282,324,173,26,378,294,31,125,339,85,279,318,301,376,358,158,353,204,152,161,384,247,393,129,391,27,387,63,173,161,400,339,115,325,297,206,276,72,120,331,66,132,405,227,106,109,108,208,9,6,4,127,331,67,205,123,237,168,43,155,35,174,94,66,85,91,127,114,241,122,419,346,243,131,151,420,327,162,24,422,223,328,419,7,138,153,149,206,426,204,179,424,157,376,155,200,251,162,431,432,336,30,251,296,165,137,27,439,67,214,283,155,421,370,7,375,363,133,126,5,181,34,123,302,231,409,341,32,254,285,184,306,191,56,247,289,165,34,220,108,238,248,43,362,303,243,43,463,81,421,15,188,409,23,116,150,100,250,214,280,186,21,332,56,225,45,76,230,112,216,457,100,246,219,122,213,268,43,431,170,351,127,262,235,24,297,22,330,1,401,403,30,202,208,80,251,450,477,12,108,260,32,7,355,296,371,189,8,329,251,482,298,156,113,71,315,93,7,317,226,214,245,115,163,110,5,328,327,126,36,86,66,64,176,198,91,136,63,283,93,33,128,91,150,406,462,170,458,22,94,432,281,363,9,52,408,315,425,308,468,311,7,78,70,223,313,111,338,410,191,333,421,494,472,385,496,166,168,35,115,378,95,273,125,241,132,172,275,232,56,236,146,278,497,416,423,171,262,193,428,118,191,213,66,262,205,286,45,317,340,289,66,467,210,180,296,379,30,108,66,78,465,248,163,106,302,230,1,6,456,248,22,361,275,371,34,395,432,220,4,391,504,222,157,6,116,312,243,283,462,22,149,91,164,502,81,369,397,311,451,351,181,338,102,101,361,183,155,43,265,503,146,205,366,137,267,167,299,499,455,55,89,384,433,237,512,48,8,175,406,508,253,431,98,212,228,348,66,268,79,415,185,249,94,472,165,436,501,279,312,470,124,401,78,364,322,199,475,158,57,354,85,49,320,432,74,377,496,434,313,191,118,71,455,74,3,249,85,195,483,356,400,311,407,101,200,7,219,412,109,32,338,127,369,3,284,271,428,136,395,235,168,160,97,181,347,366,81,1,333,218,332,147,29,334,93,83,337,172,384,141,63,37,275,259,502,66,436,400,324,41,169,249,244,117,231,125,150,1,518,120,244,10,334,51,449,316,57,151,318,46,332,91,231,57,4,56,236,106,149,409,216,171,261,27,91,357,66,0,168,77,507,80,136,377,295,108,286,174,172,209,158,254,387,332,451,452,43,85,1,384,4,28,518,314,469,381,351,238,324,22,232,406,32,64,94,409,186,224,231,354,5,249,266,377,91,403],[7,5,7,6,0,0,5,10,10,0,10,0,0,0,0,0,0,0,0,8,9,0,0,10,0,0,10,10,0,10,0,0,0,0,1,7,7,7,0,0,0,6,0,0,0,0,5,0,0,0,0,0,0,0,9,0,0,0,9,0,0,0,0,0,0,6,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,10,0,0,10,0,0,0,0,7,10,0,10,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,8,10,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,9,0,0,7,0,0,0,8,9,0,0,8,0,0,0,7,0,0,0,0,7,0,10,0,0,0,0,0,0,9,0,0,8,8,0,0,10,9,0,0,0,0,0,6,0,0,0,6,8,0,0,9,0,8,8,0,9,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,10,8,0,7,0,0,0,8,9,8,9,0,0,0,0,8,7,0,0,0,0,0,9,9,0,0,7,0,0,6,0,0,0,0,0,0,6,8,0,0,0,0,8,0,9,0,4,0,0,0,0,0,0,7,0,9,0,0,0,7,0,7,3,0,0,5,7,9,8,0,0,0,10,0,0,0,0,0,0,9,0,9,0,5,0,8,4,0,0,0,0,0,0,0,0,0,7,9,0,7,0,0,0,0,0,0,6,8,7,0,8,8,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,0,0,0,0,0,0,10,0,0,8,7,0,0,0,8,0,0,0,0,0,0,0,8,8,7,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,8,0,0,0,0,0,7,0,0,0,0,0,0,0,0,7,0,0,0,0,0,5,5,8,0,0,8,0,9,0,0,9,0,0,0,0,8,0,0,0,0,8,5,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,7,0,10,8,0,0,8,0,0,5,8,0,0,0,0,7,0,8,0,0,8,0,0,0,0,0,0,0,0,9,0,0,7,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,6,5,0,10,0,0,0,9,7,0,0,0,0,0,0,0,0,10,0,0,7,0,0,0,9,10,10,0,0,0,8,6,0,7,0,5,0,8,5,8,0,0,0,0,0,6,0,0,0,0,6,7,8,0,0,0,0,0,0,0,0,0,0,7,0,5,0,0,0,7,4,0,0,0,6,10,0,0,0,10,0,0,0,0,0,0,8,8,0,0,0,9,8,0,0,8],["Wicked: The Life and Times of the Wicked Witch of the West","Midnight in the Garden of Good and Evil","Like Water for Chocolate : A Novel in Monthly Installments with Recipes, Romances, and Home Remedies","The Amazing Adventures of Kavalier &amp;amp; Clay","The Firm","Snow Falling on Cedars","Certain Prey","Angela's Ashes: A Memoir","The Gunslinger (The Dark Tower, Book 1)","Congo","Anne Frank: The Diary of a Young Girl","Lucky : A Memoir","Where the Heart Is (Oprah's Book Club (Paperback))","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Beach Music","At Home in Mitford (The Mitford Years)","She's Come Undone (Oprah's Book Club)","Fine Things","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Deja Dead","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Angels &amp;amp; Demons","Lightning","Atonement : A Novel","Bridget Jones: The Edge of Reason","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","Anne of the Island","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","K Is for Killer (Kinsey Millhone Mysteries (Paperback))","A Time to Kill","The Kitchen God's Wife","G Is for Gumshoe (Kinsey Millhone Mysteries (Paperback))","Dawn (Cutler)","Black Notice","The Rainmaker","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Two for the Dough","The Return of the King (The Lord of the Rings, Part 3)","Kiss the Girls","Chicken Soup for the Soul (Chicken Soup for the Soul)","The Alienist","Zen and the Art of Motorcycle Maintenance: An Inquiry into Values","Watchers","The Bourne Identity","Mystic River","The King of Torts","Wild Animus","The Gunslinger (The Dark Tower, Book 1)","Night Sins","Morality for Beautiful Girls (No.1 Ladies Detective Agency)","Mystic River","The Rescue","The Street Lawyer","Ender's Game (Ender Wiggins Saga (Paperback))","A Wrinkle in Time","Along Came a Spider (Alex Cross Novels)","Message in a Bottle","Rising Sun","American Gods","Three Junes","One True Thing","Bel Canto: A Novel","The Queen of the Damned (Vampire Chronicles (Paperback))","Saving Faith","Fahrenheit 451","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","At Home in Mitford (The Mitford Years)","The Mists of Avalon","To Kill a Mockingbird","Tears of the Giraffe (No.1 Ladies Detective Agency)","Back Roads","All That Remains (Kay Scarpetta Mysteries (Paperback))","Life of Pi","Insomnia","The Simple Truth","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Wild Animus","Outlander","Lake Wobegon days","Inner Harbor (Quinn Brothers (Paperback))","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","Neverwhere","The Green Mile","Chocolat","Wicked: The Life and Times of the Wicked Witch of the West","Vinegar Hill (Oprah's Book Club (Paperback))","Animal Dreams","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","Jewel (Oprah's Book Club)","Cruel &amp;amp; Unusual (Kay Scarpetta Mysteries (Paperback))","Artemis Fowl (Artemis Fowl, Book 1)","The Lost Boy: A Foster Child's Search for the Love of a Family","The Celestine Prophecy (Celestine Prophecy)","A Child Called \\It\\\": One Child's Courage to Survive\"","Jewels of the Sun (Irish Trilogy)","The Firm","The Rainmaker","Billy Straight : A Novel","Dragonfly in Amber","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Contact","The Bonfire of the Vanities","Angels &amp;amp; Demons","Congo","Zoya","While I Was Gone","A Thousand Acres (Ballantine Reader's Circle)","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","I Know This Much Is True","Still Waters","Ashes to Ashes","House of Sand and Fog","Jewel (Oprah's Book Club)","Dance upon the Air (Three Sisters Island Trilogy)","Needful Things","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Jack &amp;amp; Jill (Alex Cross Novels)","Postmortem","Message in a Bottle","The Five People You Meet in Heaven","Point of Origin","A Time to Kill","2nd Chance","Violets Are Blue","Inner Harbor (Quinn Brothers (Paperback))","Remember Me","Roses Are Red (Alex Cross Novels)","Black Notice","Zoya","Disclosure","Invasion","The Last Precinct","Red Dragon","Hornet's Nest","The Andromeda Strain","The Hundred Secret Senses","The Plains of Passage (Earth's Children (Paperback))","Congo","Long After Midnight","Kaleidoscope","Needful Things","The Last Precinct","The Blue Nowhere : A Novel","Point of Origin","The Killing Game: Only One Can Win...and the Loser Dies","A Child Called \\It\\\": One Child's Courage to Survive\"","Vinegar Hill (Oprah's Book Club (Paperback))","Midwives: A Novel","I Know This Much Is True (Oprah's Book Club)","Angels &amp;amp; Demons","River, Cross My Heart","Mr. Murder","The Lovely Bones: A Novel","The Da Vinci Code","Blood Work","Hot Six : A Stephanie Plum Novel (A Stephanie Plum Novel)","SHIPPING NEWS","The Pilot's Wife : A Novel","The Joy Luck Club","While I Was Gone","Angela's Ashes: A Memoir","Five Quarters of the Orange","The Reader","The Secret Life of Bees","Mr. Murder","Fried Green Tomatoes at the Whistle Stop Cafe","House of Sand and Fog","The Poisonwood Bible: A Novel","She's Come Undone (Oprah's Book Club (Paperback))","The Kitchen God's Wife","Wild Animus","Angela's Ashes (MMP) : A Memoir","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","Cradle and All","She's Come Undone (Oprah's Book Club)","The Lovely Bones: A Novel","A Time to Kill","A Prayer for Owen Meany","The Secret Life of Bees","A Fine Balance","One True Thing","A Map of the World","All the Pretty Horses (The Border Trilogy, Vol 1)","The Bonfire of the Vanities","White Oleander : A Novel","Life of Pi","Sophie's World: A Novel About the History of Philosophy","Hannibal","I Is for Innocent","Insomnia","Skipping Christmas","Harry Potter and the Chamber of Secrets (Book 2)","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","Sleepers","All the Pretty Horses (The Border Trilogy, Vol 1)","The Red Tent (Bestselling Backlist)","Anne of Avonlea (Anne of Green Gables Novels (Paperback))","The Brethren","The Tommyknockers","Midwives: A Novel","Moonlight Becomes You","Disclosure","It Was on Fire When I Lay Down on It","The Idiot Girls' Action Adventure Club","All I Really Need to Know","Remember Me","Angela's Ashes (MMP) : A Memoir","The Hours: A Novel","The Book of Ruth (Oprah's Book Club (Paperback))","Insomnia","The Thorn Birds","Before I Say Good-Bye","The Villa","The Pelican Brief","The Book of Ruth (Oprah's Book Club (Paperback))","Good in Bed","Chicken Soup for the Soul (Chicken Soup for the Soul)","Charlotte's Web (Trophy Newbery)","Congo","Girl in Hyacinth Blue","Fried Green Tomatoes at the Whistle Stop Cafe","The Nanny Diaries: A Novel","Secret History","Angela's Ashes (MMP) : A Memoir","The Client","Timeline","The Red Tent (Bestselling Backlist)","The Girls' Guide to Hunting and Fishing","Tara Road","Dude, Where's My Country?","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","How to Be Good","The Rainmaker","Lucky : A Memoir","The Poisonwood Bible: A Novel","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","Bridget Jones : The Edge of Reason","Fast Food Nation: The Dark Side of the All-American Meal","Sisterhood of the Traveling Pants","The Firm","Animal Dreams","Outlander","One for the Money (Stephanie Plum Novels (Paperback))","Hearts In Atlantis","The Next Accident","Interview with the Vampire","Hornet's Nest","Seven Up (A Stephanie Plum Novel)","Chicken Soup for the Soul (Chicken Soup for the Soul)","Lucky : A Memoir","The Notebook","The Joy Luck Club","The Rapture of Canaan","A Walk to Remember","Wild Animus","Suzanne's Diary for Nicholas","Into Thin Air : A Personal Account of the Mt. Everest Disaster","White Oleander : A Novel","Wild Animus","The Surgeon","A Thin Dark Line (Mysteries &amp;amp; Horror)","The Client","The Virgin Suicides","Lord of the Flies","Fast Food Nation: The Dark Side of the All-American Meal","The Girls' Guide to Hunting and Fishing","Fine Things","A Painted House","The Pillars of the Earth","The Clan of the Cave Bear (Earth's Children (Paperback))","The Nanny Diaries: A Novel","Dying for Chocolate (Culinary Mysteries (Paperback))","The Valley of Horses","Bel Canto: A Novel","Silence of the Lambs","Interview with the Vampire","Ashes to Ashes","Flesh and Blood","F Is for Fugitive (Kinsey Millhone Mysteries (Paperback))","The Queen of the Damned (Vampire Chronicles (Paperback))","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Contact","Touching Evil","The Pillars of the Earth","When the Wind Blows","The King of Torts","A Map of the World","Night Sins","What Looks Like Crazy On An Ordinary Day","Wild Animus","The Thorn Birds","Dreamcatcher","Face the Fire (Three Sisters Island Trilogy)","The Secret Life of Bees","The Prince of Tides","Back Roads","Skipping Christmas","Vinegar Hill (Oprah's Book Club (Paperback))","Snow Falling on Cedars","The Celestine Prophecy (Celestine Prophecy)","I Know This Much Is True","Shopaholic Ties the Knot","Song of Solomon (Oprah's Book Club (Paperback))","The Pelican Brief","Tears of the Giraffe (No.1 Ladies Detective Agency)","While I Was Gone","Daisy Fay and the Miracle Man","The Book of Ruth (Oprah's Book Club (Paperback))","The Bad Beginning (A Series of Unfortunate Events, Book 1)","L Is for Lawless","Songs in Ordinary Time (Oprah's Book Club (Paperback))","The Joy Luck Club","Angus, Thongs and Full-Frontal Snogging: Confessions of Georgia Nicolson","The Firm","The Red Tent (Bestselling Backlist)","Jewel","Good in Bed","The Body Farm","The Return of the King (The Lord of the Rings, Part 3)","STONES FROM THE RIVER","The Lost Boy: A Foster Child's Search for the Love of a Family","The Book of Ruth (Oprah's Book Club (Paperback))","Rules of Prey","Absolute Power","The Bourne Identity","N Is for Noose","Full House (Janet Evanovich's Full Series)","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","The Horse Whisperer","The Red Tent (Bestselling Backlist)","Blessings","Wish You Well","The Nanny Diaries: A Novel","Pay It Forward","The Killing Game: Only One Can Win...and the Loser Dies","Confessions of a Shopaholic (Summer Display Opportunity)","M Is for Malice","How to Be Good","Sleepers","I Is for Innocent","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","A Is for Alibi (Kinsey Millhone Mysteries (Paperback))","Evening Class","The Lovely Bones: A Novel","At Home in Mitford (The Mitford Years)","Slaughterhouse Five or the Children's Crusade: A Duty Dance With Death","Isle of Dogs","A Prayer for Owen Meany","Bridget Jones: The Edge of Reason","Kaleidoscope","Secret History","The Horse Whisperer","Sphere","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","A Prayer for Owen Meany","A Painted House","Hearts in Atlantis","Midnight Bayou","Dreamcatcher","Engaging The Enemy","Snow Falling on Cedars","She's Come Undone (Oprah's Book Club)","Before I Say Good-Bye","Three Fates","Tara Road","Angela's Ashes: A Memoir","Couplehood","How to Make an American Quilt","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","Breathing Lessons","A Thousand Acres (Ballantine Reader's Circle)","My Gal Sunday","Rising Sun","The Red Tent (Bestselling Backlist)","Icy Sparks","Hideaway","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","Neuromancer (Remembering Tomorrow)","The Runaway Jury","The Color Purple","Into the Wild","The Next Accident","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","The Client","The Robber Bride","Full Tilt (Janet Evanovich's Full Series)","Airframe","Monster : A Novel (Alex Delaware Novels (Paperback))","1984","The Kitchen God's Wife","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","The Killing Game: Only One Can Win...and the Loser Dies","Jack &amp;amp; Jill (Alex Cross Novels)","Lightning","A Wrinkle in Time","The Five People You Meet in Heaven","One True Thing","The Da Vinci Code","The Dark Half","Seven Habits Of Highly Effective People","Shopaholic Takes Manhattan (Summer Display Opportunity)","Interview with the Vampire","The Mummy or Ramses the Damned","Jurassic Park","I Know Why the Caged Bird Sings","The Murder Book","The Princess Bride: S Morgenstern's Classic Tale of True Love and High Adventure","Fear Nothing","The Fellowship of the Ring (The Lord of the Rings, Part 1)","The Prince of Tides","\\O\\\" Is for Outlaw\"","What to Expect When You're Expecting (Revised Edition)","High Five (A Stephanie Plum Novel)","The Next Accident","Night Sins","The Lovely Bones: A Novel","The Prince of Tides","House of Sand and Fog","1st to Die: A Novel","Flesh and Blood","Blessings","Still Waters","Seven Up (A Stephanie Plum Novel)","The Lovely Bones: A Novel","Whirlwind (Tyler, Book 1)","A Heartbreaking Work of Staggering Genius","The Lost World","Good in Bed","Hide &amp;amp; Seek","The Pelican Brief","The Joy Luck Club","The Lovely Bones: A Novel","Icy Sparks","The Cardinal of the Kremlin (Jack Ryan Novels)","A Walk to Remember","Confessions of a Shopaholic (Summer Display Opportunity)","SHIPPING NEWS","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","The Queen of the Damned (Vampire Chronicles (Paperback))","I Know This Much Is True","Five Quarters of the Orange","Chosen Prey","A Walk to Remember","Snow Falling on Cedars","Let Me Call You Sweetheart","Seven Habits Of Highly Effective People","The Body Farm","Lucky : A Memoir","We Were the Mulvaneys","Before I Say Good-Bye","The Notebook","The Reader","The Plains of Passage (Earth's Children (Paperback))","The Glass Lake","The Last Time They Met : A Novel","All I Really Need to Know","Five Quarters of the Orange","Fine Things","Drowning Ruth (Oprah's Book Club)","White Oleander : A Novel","Secret History","Midnight Bayou","Snow Falling on Cedars","The Tommyknockers","A Prayer for Owen Meany","Harry Potter and the Chamber of Secrets (Book 2)","The Burden of Proof","A Thin Dark Line (Mysteries &amp;amp; Horror)","I'll Be Seeing You","The Witching Hour (Lives of the Mayfair Witches)","Rising Sun","Debt of Honor (Jack Ryan Novels)","Face the Fire (Three Sisters Island Trilogy)","The Rainmaker","The Color Purple","CAT'S EYE","The Summerhouse","Let Me Call You Sweetheart","The Tao of Pooh","Angela's Ashes (MMP) : A Memoir","Wild Animus","The Stone Diaries","Crazy for You","Jurassic Park","House of Sand and Fog","Carolina Moon","Charlotte's Web (Trophy Newbery)","Here on Earth","Loves Music, Loves to Dance","The Simple Truth","The Lottery Winner : Alvirah And Willy Stories","Riptide","Guilty as Sin","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Red Dragon","Heaven and Earth (Three Sisters Island Trilogy)","She's Come Undone (Oprah's Book Club (Paperback))","The Hobbit : The Enchanting Prelude to The Lord of the Rings","The Gunslinger (The Dark Tower, Book 1)","STONES FROM THE RIVER","Dolores Claiborne","Hearts in Atlantis","Sea Swept (Quinn Brothers (Paperback))","Three Junes","The Thorn Birds","Big Stone Gap: A Novel (Ballantine Reader's Circle)","Under the Tuscan Sun","Turtle Moon","Scarlet Feather","The Lovely Bones: A Novel","What Looks Like Crazy On An Ordinary Day","Beach Music","The Catcher in the Rye","Divine Secrets of the Ya-Ya Sisterhood: A Novel","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","She's Come Undone (Oprah's Book Club)","Full Tilt (Janet Evanovich's Full Series)","Chicken Soup for the Soul (Chicken Soup for the Soul)","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","Tears of the Moon (Irish Trilogy)","2nd Chance","Drowning Ruth (Oprah's Book Club)","Sanctuary","Atonement : A Novel","Shopaholic Ties the Knot","Icy Sparks","Pretend You Don't See Her","Along Came a Spider (Alex Cross Novels)","The Giver (21st Century Reference)","The Loop","Black Notice","To Kill a Mockingbird","Secrets","A Time to Kill","Anne Frank: The Diary of a Young Girl","Little Altars Everywhere: A Novel","Before I Say Good-Bye","Deja Dead","From Potter's Field","Monster : A Novel (Alex Delaware Novels (Paperback))","Fatal Cure","Neuromancer (Remembering Tomorrow)","The Next Accident","High Five (A Stephanie Plum Novel)","Full House (Janet Evanovich's Full Series)","Riptide","Deja Dead","Empire Falls","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","A Time to Kill","Mystic River","The Return Journey","The Tale of the Body Thief (Vampire Chronicles (Paperback))","The Blue Nowhere : A Novel","Rising Sun","Final Target","The Summerhouse","The Hours: A Novel","The Red Tent (Bestselling Backlist)","The King of Torts","The Weight of Water : A Novel Tag: Author of Resistance and Strange Fits of Passion","The Pilot's Wife : A Novel","The Firm","The Color Purple","The Secret Life of Bees","I'll Be Seeing You","Empire Falls","Balzac and the Little Chinese Seamstress : A Novel","The Dogs of Babel (Today Show Book Club #12)","What to Expect When You're Expecting (Revised Edition)","Bridget Jones: The Edge of Reason","We Were the Mulvaneys","Back Roads","The Kitchen God's Wife","The Bad Place","Shell Seekers","The Rainmaker","Wanderlust","Carolina Moon","A Thin Dark Line (Mysteries &amp;amp; Horror)","I Know This Much Is True","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","Neverwhere","Silence of the Lambs","The Chamber","Two for the Dough","Rose Madder","The Horse Whisperer","The Cereal Murders","Jewels of the Sun (Irish Trilogy)","The Dark Half","Red Dragon","The Great Gatsby","Kaleidoscope","The Beach House","Seven Habits Of Highly Effective People","To the Nines: A Stephanie Plum Novel","The Burden of Proof","The Lovely Bones: A Novel","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","The Blue Nowhere : A Novel","Dance upon the Air (Three Sisters Island Trilogy)","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Chicken Soup for the Woman's Soul (Chicken Soup for the Soul Series (Paper))","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","The Angel of Darkness","Where the Heart Is (Oprah's Book Club (Paperback))","Bridget Jones : The Edge of Reason","The Five People You Meet in Heaven","A Painted House","I Know This Much Is True","The Devil Wears Prada : A Novel","River, Cross My Heart","The Angel of Darkness","The Color of Water: A Black Man's Tribute to His White Mother","Rose Madder","The Perfect Storm : A True Story of Men Against the Sea","The Bean Trees","Love in the Time of Cholera (Penguin Great Books of the 20th Century)","To Kill a Mockingbird","Sophie's World: A Novel About the History of Philosophy","Violets Are Blue","A Great Deliverance","Silence of the Lambs","A Prayer for Owen Meany","Bridget Jones : The Edge of Reason","To Kill a Mockingbird","The Reader","Interview with the Vampire","The Mummy or Ramses the Damned","SHIPPING NEWS","The Tommyknockers","Fast Food Nation: The Dark Side of the All-American Meal","Contact","The Fellowship of the Ring (The Lord of the Rings, Part 1)","Lake Wobegon days","Congo","A Prayer for Owen Meany","The Vampire Lestat (Vampire Chronicles, Book II)","The Lovely Bones: A Novel","Girl, Interrupted","The Kitchen God's Wife","The Alienist","All Around the Town","Daisy Fay and the Miracle Man","Bridget Jones: The Edge of Reason","From Potter's Field","White Teeth: A Novel","The Joy Luck Club","1st to Die: A Novel","Cradle and All","The Dark Half","The Summons","Black Notice","Animal Dreams","Long After Midnight","Silence of the Lambs","Debt of Honor (Jack Ryan Novels)","4 Blondes","Wild Animus","A Time to Kill","I Know This Much Is True","Red Dragon","The Reader","The Ugly Duckling","The Devil Wears Prada : A Novel","Big Cherry Holler: A Big Stone Gap Novel (Ballantine Reader's Circle)","Nerd in Shining Armor","Key of Light (Key Trilogy (Paperback))","Face the Fire (Three Sisters Island Trilogy)","The Rapture of Canaan","Dance upon the Air (Three Sisters Island Trilogy)","Snow Falling on Cedars","Shopaholic Takes Manhattan (Summer Display Opportunity)","Hearts in Atlantis","The Firm","At Home in Mitford (The Mitford Years)","She's Come Undone (Oprah's Book Club)","Fast Food Nation: The Dark Side of the All-American Meal","The Valley of Horses","The Other Boleyn Girl","Bridget Jones : The Edge of Reason","Secrets","How to Be Good","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","Girl with a Pearl Earring","From Potter's Field","A Prayer for Owen Meany","Song of Solomon (Oprah's Book Club (Paperback))"],[4.35,7.04,4.82,0.66,3.17,0.88,0.02,4.72,0.06,0.54,1.87,0,0.59,1.49,2.52,0.01,0.43,2.52,0.58,3.55,0.14,0,2.78,1.52,0,0.05,0.9399999999999999,8.720000000000001,9.75,7.42,2.01,0.27,5.29,5.07,2.52,0,6.32,5.33,4.1,0.17,2.22,0,1.8,0.04,7.7,0.62,1.59,1.23,1.42,0.06,4.06,1.58,1.51,2.89,3.05,1.93,1.74,0.07000000000000001,1.39,2.49,1.71,1.73,0.9,0.24,0.39,0,0,3.82,0.86,0.05,5.84,0.22,0,0.18,0.38,0.06,0.7,1.2,3.18,9.5,0,0.7,2.07,4.46,0,7.84,6.18,0,0.27,4.26,0.5,0,0.01,0.01,0,0.01,0.67,0.28,0.62,0.02,0.05,0.37,0.08,0.52,0.2,5.02,0.16,1.35,4.8,0,7.95,9.43,0.28,0.04,3.7,5.98,1.48,3.44,1.29,0.42,2.19,0.09,1.61,0.8100000000000001,1.27,0.63,3.41,0.78,0.09,0.88,0,0.58,0.24,0,0.25,0,0.01,0.95,0.78,0.16,0.18,0.03,0.07000000000000001,0.82,0.08,0.02,0.78,0,0.16,0.1,4.13,0,3.23,0.07000000000000001,8.029999999999999,1.13,5.14,5.59,11.07,1.33,5.4,6.06,4.88,3.81,1.88,5.08,0.15,10.31,0.01,0.9399999999999999,0.19,0.28,1.05,0,3.33,5.36,3.52,0.7,0.62,0.67,4.08,0,0.02,0.86,0.84,0.19,0,0.16,8.460000000000001,13.15,8.1,1.18,1.48,2.52,2,0.62,0.23,0.17,0.92,4.67,0.02,3.51,3.75,3.38,0.35,0.03,4.22,1.07,1.2,0.91,0.36,0.34,2.02,8.67,0.03,0,2.74,0.05,0.59,0,1.94,0.36,0.91,0.03,1.01,0,0.05,1.95,6.18,0.8,0.1,0.71,0.65,1.06,0.18,0.51,0.62,2.32,1.18,0.15,0.11,0.47,0.71,1.8,3.76,3.91,0.85,0,0.14,0.11,3.62,0,0.07000000000000001,0.9399999999999999,6.56,2.87,5.81,0.03,1.03,1.28,2.43,0.04,0.08,4.28,0.12,4.73,6.96,1.93,1.45,1.69,4.41,2.78,0.9399999999999999,1.17,0.03,7.11,0.74,0.73,2.04,0.14,0.05,3.02,1.12,1.69,5.42,0.42,2.29,0.28,0.49,3.15,2.7,2.24,1.89,0.07000000000000001,1.92,5.74,0.21,0.45,0,2.23,0.98,11.65,2.13,0.04,6.04,0.21,5.8,1.74,9.07,4.3,0.17,0,2.99,0,3.44,2.95,3.21,4.85,3.46,3.78,2.54,0,0.45,0.68,0.05,0.48,0.62,2.46,0,5.1,0.1,0.27,0.85,0.97,2.33,2.39,0.13,0.07000000000000001,0.35,0,1.61,0.26,1.12,4.37,1.89,0,11.92,5.44,5.1,0.48,2.99,0.78,0.03,0,1.29,2.21,5.1,0.49,3.33,0.04,0.03,0.45,0.77,0.95,2.31,0.01,0.01,2.89,0.36,1.85,0.09,0.24,3.05,0,0.02,0.29,0.82,1.33,0.2,0.07000000000000001,6.91,2.5,7.71,6.43,0.31,0.25,0.7,4.55,0.35,4.02,2,0,1.09,4.82,0.03,1.47,0,4.55,3.84,1.32,1.65,3.4,1.88,1.11,5.39,3.31,1.07,1.61,2,0.22,0.01,0.07000000000000001,4.44,2.27,3.51,2.42,0.05,4.7,4.79,3.45,2.87,1.6,0.16,0.83,0.01,2.58,10.52,0,0.6899999999999999,0.4,0.44,0.5600000000000001,1.66,3.64,1.28,4.59,0.04,0.39,4.14,3.86,2.06,2.3,2.04,0.6899999999999999,0.06,0.11,0.13,0.22,0.64,0.58,0.11,0.14,0.06,0.12,1.16,2.43,1.71,6.6,0.84,3.33,1.52,2.4,3.06,0.09,0,0.03,0.01,0.06,0.06,0.01,0.06,0,0.03,0.05,0,0.14,0.09,0.15,0.02,0.03,0.02,0.04,0.13,0,0.02,0.01,0.17,0.06,0.13,0.18,0.03,0.09,0,0.02,0.03,0,0,0,0.04,0.06,0.18,0.01,0.8100000000000001,1.74,0,1.08,4.36,6.89,0.25,0.61,0.46,1.72,2.2,6.08,0.07000000000000001,3.42,3.47,5.64,3.68,0.6899999999999999,0.08,5.31,0.18,1.66,1.59,0.85,0,1.04,0.7,1.75,0.54,0.03,5.28,0,6.05,0,0.91,4.16,4.12,0.03,1.66,1.87,2,1.34,5.79,2.93,9.130000000000001,9.050000000000001,2.87,2.37,6.74,6.05,6.53,2.76,0.85,3.41,0.01,3.31,0.31,5.11,0.35,0.8100000000000001,0.45,5.18,6.84,1.23,5.26,0,0.01,0.89,3.58,1.69,3.86,1.07,0.97,0,0.09,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,5.06,0.87,2.1,11.86,2.23,1.27,2.81,9.4,0,0.78,0.61,13.15,5.95,0.02,0.8100000000000001,0.16,2.86,5.8,0.23,2,3.51,0.3,4.11,3.48,0,3.5,7.15,8.33,2.5,7.59,0.24,2.84,2.94,0.46,6.22,1.91,3.29,0.08,3.64,0.57,0.05,5.84,0,0.04,0.79,2.55,7.12,4.08,1.67,0.51,0,0.49,1.4,0,0.38,0.61,2.17,0.3,0.43,2.99,0.01,0,0.51,0.25,1.76,0.01,0.1,0.02,3.18,2.5,0.01,5.64,1.92,2,1.83,0.87,3.57,5.37,4.57,1.48,0.9,1.49,0,0.45,2.95,7.51,4.94,4.91,0.71,1.08,0,4.26,7.92,5.26,1.69,2.96,0.22]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>user_id<\/th>\n      <th>ISBN<\/th>\n      <th>rating<\/th>\n      <th>title<\/th>\n      <th>predicted_rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,4]},{"name":"user_id","targets":0},{"name":"ISBN","targets":1},{"name":"rating","targets":2},{"name":"title","targets":3},{"name":"predicted_rating","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s look at the distribution of the predicted ratings</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_data<span class="sc">$</span>predicted_rating,  <span class="at">main =</span> <span class="st">"Histogram of the predicted ratings for all observations in the</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="st">     test data using the matrix factorization model"</span>,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted rating"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution is skewed to the right, most observations have a predicted ratings between 0 and 1. And the number of observations decreases as the rating gets higher. The model is producing raw predictions without any constraints or normalization, because we also observe ratings greater than 10.</p>
</section>
<section id="l2-regularization-on-the-matix-factorization" class="level3">
<h3 class="anchored" data-anchor-id="l2-regularization-on-the-matix-factorization">L2 regularization on the Matix factorization</h3>
<p>For regularization we aplied L2 regularization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty Reco object</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">Reco</span>()</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tune hyperparameters including regularization terms (L2 regularization)</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>opts <span class="ot">&lt;-</span> rs<span class="sc">$</span><span class="fu">tune</span>(reco_train, <span class="at">opts =</span> <span class="fu">list</span>(</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>),            </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">costp_l2 =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),    </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">costq_l2 =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>),     </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">lrate =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>),           </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">niter =</span> <span class="dv">50</span>,                     </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nthread =</span> <span class="dv">4</span>                     </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model with the best hyperparameters from tuning</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rs<span class="sc">$</span><span class="fu">train</span>(reco_train, <span class="at">opts =</span> <span class="fu">c</span>(opts<span class="sc">$</span>min, <span class="at">niter =</span> <span class="dv">50</span>, <span class="at">nthread =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iter      tr_rmse          obj
   0       3.6305   4.5560e+04
   1       3.5001   4.3323e+04
   2       3.3883   4.1730e+04
   3       3.3034   4.0620e+04
   4       3.2348   3.9710e+04
   5       3.1854   3.9106e+04
   6       3.1469   3.8683e+04
   7       3.1192   3.8394e+04
   8       3.0919   3.8108e+04
   9       3.0732   3.7905e+04
  10       3.0573   3.7755e+04
  11       3.0378   3.7515e+04
  12       3.0296   3.7475e+04
  13       3.0181   3.7367e+04
  14       3.0049   3.7194e+04
  15       2.9944   3.7062e+04
  16       2.9903   3.7044e+04
  17       2.9830   3.6967e+04
  18       2.9765   3.6930e+04
  19       2.9736   3.6956e+04
  20       2.9621   3.6781e+04
  21       2.9610   3.6831e+04
  22       2.9548   3.6772e+04
  23       2.9460   3.6650e+04
  24       2.9454   3.6713e+04
  25       2.9373   3.6594e+04
  26       2.9355   3.6611e+04
  27       2.9309   3.6575e+04
  28       2.9251   3.6534e+04
  29       2.9218   3.6512e+04
  30       2.9152   3.6439e+04
  31       2.9134   3.6436e+04
  32       2.9113   3.6475e+04
  33       2.9036   3.6384e+04
  34       2.8996   3.6348e+04
  35       2.8954   3.6339e+04
  36       2.8912   3.6295e+04
  37       2.8838   3.6199e+04
  38       2.8821   3.6220e+04
  39       2.8787   3.6218e+04
  40       2.8727   3.6163e+04
  41       2.8688   3.6134e+04
  42       2.8648   3.6109e+04
  43       2.8603   3.6069e+04
  44       2.8568   3.6071e+04
  45       2.8509   3.6004e+04
  46       2.8477   3.6009e+04
  47       2.8438   3.5993e+04
  48       2.8380   3.5936e+04
  49       2.8329   3.5911e+04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ratings for the test set</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>pred_ratings <span class="ot">&lt;-</span> rs<span class="sc">$</span><span class="fu">predict</span>(reco_test)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RMSE (Root Mean Squared Error) as a measure of accuracy</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((pred_ratings <span class="sc">-</span> test_data<span class="sc">$</span>rating)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Matrix Factorisation RMSE (Regularization):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix Factorisation RMSE (Regularization): 3.61</code></pre>
</div>
</div>
<p>There is a significant decrease in RMSE when regularization is applied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ratings for the test set</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>MF_pred_l2 <span class="ot">&lt;-</span> rs<span class="sc">$</span><span class="fu">predict</span>(reco_test)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store predictions in the test dataset with the predicted ratings after L2 regularization</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>pred_data_l2 <span class="ot">&lt;-</span> test_data <span class="sc">|&gt;</span> </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted_rating =</span> <span class="fu">round</span>(MF_pred_l2, <span class="dv">2</span>)  <span class="co"># Rounding predictions to 2 decimal places</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View predictions using the datatable library</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(pred_data_l2, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7531f021030c44f57ef2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7531f021030c44f57ef2">{"x":{"filter":"none","vertical":false,"data":[[0,0,0,0,1,1,2,3,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,20,20,20,20,20,20,20,20,21,22,22,22,22,22,23,24,24,24,25,25,25,25,25,25,25,25,25,25,25,26,26,27,27,27,27,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,44,44,45,45,45,46,46,46,46,46,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,55,55,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,64,64,64,64,64,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,71,71,71,71,71,71,72,73,73,73,73,74,74,74,74,75,76,76,76,77,77,77,78,78,78,78,79,79,79,80,80,80,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86],[14,18,13,2,32,22,40,9,48,27,49,34,117,35,26,79,64,94,116,112,74,89,69,72,95,124,136,128,130,126,87,85,168,68,154,158,181,69,29,189,190,165,77,182,92,156,195,194,43,48,213,215,195,84,192,203,273,322,31,311,145,253,241,21,230,264,105,69,64,233,57,202,235,242,131,162,299,41,43,285,261,301,128,218,290,269,14,297,254,35,282,39,258,329,330,325,337,32,181,82,144,26,112,216,346,72,27,353,208,308,249,1,340,225,205,282,324,173,26,378,294,31,125,339,85,279,318,301,376,358,158,353,204,152,161,384,247,393,129,391,27,387,63,173,161,400,339,115,325,297,206,276,72,120,331,66,132,405,227,106,109,108,208,9,6,4,127,331,67,205,123,237,168,43,155,35,174,94,66,85,91,127,114,241,122,419,346,243,131,151,420,327,162,24,422,223,328,419,7,138,153,149,206,426,204,179,424,157,376,155,200,251,162,431,432,336,30,251,296,165,137,27,439,67,214,283,155,421,370,7,375,363,133,126,5,181,34,123,302,231,409,341,32,254,285,184,306,191,56,247,289,165,34,220,108,238,248,43,362,303,243,43,463,81,421,15,188,409,23,116,150,100,250,214,280,186,21,332,56,225,45,76,230,112,216,457,100,246,219,122,213,268,43,431,170,351,127,262,235,24,297,22,330,1,401,403,30,202,208,80,251,450,477,12,108,260,32,7,355,296,371,189,8,329,251,482,298,156,113,71,315,93,7,317,226,214,245,115,163,110,5,328,327,126,36,86,66,64,176,198,91,136,63,283,93,33,128,91,150,406,462,170,458,22,94,432,281,363,9,52,408,315,425,308,468,311,7,78,70,223,313,111,338,410,191,333,421,494,472,385,496,166,168,35,115,378,95,273,125,241,132,172,275,232,56,236,146,278,497,416,423,171,262,193,428,118,191,213,66,262,205,286,45,317,340,289,66,467,210,180,296,379,30,108,66,78,465,248,163,106,302,230,1,6,456,248,22,361,275,371,34,395,432,220,4,391,504,222,157,6,116,312,243,283,462,22,149,91,164,502,81,369,397,311,451,351,181,338,102,101,361,183,155,43,265,503,146,205,366,137,267,167,299,499,455,55,89,384,433,237,512,48,8,175,406,508,253,431,98,212,228,348,66,268,79,415,185,249,94,472,165,436,501,279,312,470,124,401,78,364,322,199,475,158,57,354,85,49,320,432,74,377,496,434,313,191,118,71,455,74,3,249,85,195,483,356,400,311,407,101,200,7,219,412,109,32,338,127,369,3,284,271,428,136,395,235,168,160,97,181,347,366,81,1,333,218,332,147,29,334,93,83,337,172,384,141,63,37,275,259,502,66,436,400,324,41,169,249,244,117,231,125,150,1,518,120,244,10,334,51,449,316,57,151,318,46,332,91,231,57,4,56,236,106,149,409,216,171,261,27,91,357,66,0,168,77,507,80,136,377,295,108,286,174,172,209,158,254,387,332,451,452,43,85,1,384,4,28,518,314,469,381,351,238,324,22,232,406,32,64,94,409,186,224,231,354,5,249,266,377,91,403],[7,5,7,6,0,0,5,10,10,0,10,0,0,0,0,0,0,0,0,8,9,0,0,10,0,0,10,10,0,10,0,0,0,0,1,7,7,7,0,0,0,6,0,0,0,0,5,0,0,0,0,0,0,0,9,0,0,0,9,0,0,0,0,0,0,6,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,10,0,0,10,0,0,0,0,7,10,0,10,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,8,10,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,9,0,0,7,0,0,0,8,9,0,0,8,0,0,0,7,0,0,0,0,7,0,10,0,0,0,0,0,0,9,0,0,8,8,0,0,10,9,0,0,0,0,0,6,0,0,0,6,8,0,0,9,0,8,8,0,9,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,10,8,0,7,0,0,0,8,9,8,9,0,0,0,0,8,7,0,0,0,0,0,9,9,0,0,7,0,0,6,0,0,0,0,0,0,6,8,0,0,0,0,8,0,9,0,4,0,0,0,0,0,0,7,0,9,0,0,0,7,0,7,3,0,0,5,7,9,8,0,0,0,10,0,0,0,0,0,0,9,0,9,0,5,0,8,4,0,0,0,0,0,0,0,0,0,7,9,0,7,0,0,0,0,0,0,6,8,7,0,8,8,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,0,0,0,0,0,0,10,0,0,8,7,0,0,0,8,0,0,0,0,0,0,0,8,8,7,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,8,0,0,0,0,0,7,0,0,0,0,0,0,0,0,7,0,0,0,0,0,5,5,8,0,0,8,0,9,0,0,9,0,0,0,0,8,0,0,0,0,8,5,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,7,0,10,8,0,0,8,0,0,5,8,0,0,0,0,7,0,8,0,0,8,0,0,0,0,0,0,0,0,9,0,0,7,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,6,5,0,10,0,0,0,9,7,0,0,0,0,0,0,0,0,10,0,0,7,0,0,0,9,10,10,0,0,0,8,6,0,7,0,5,0,8,5,8,0,0,0,0,0,6,0,0,0,0,6,7,8,0,0,0,0,0,0,0,0,0,0,7,0,5,0,0,0,7,4,0,0,0,6,10,0,0,0,10,0,0,0,0,0,0,8,8,0,0,0,9,8,0,0,8],["Wicked: The Life and Times of the Wicked Witch of the West","Midnight in the Garden of Good and Evil","Like Water for Chocolate : A Novel in Monthly Installments with Recipes, Romances, and Home Remedies","The Amazing Adventures of Kavalier &amp;amp; Clay","The Firm","Snow Falling on Cedars","Certain Prey","Angela's Ashes: A Memoir","The Gunslinger (The Dark Tower, Book 1)","Congo","Anne Frank: The Diary of a Young Girl","Lucky : A Memoir","Where the Heart Is (Oprah's Book Club (Paperback))","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Beach Music","At Home in Mitford (The Mitford Years)","She's Come Undone (Oprah's Book Club)","Fine Things","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Deja Dead","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Angels &amp;amp; Demons","Lightning","Atonement : A Novel","Bridget Jones: The Edge of Reason","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","Anne of the Island","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","K Is for Killer (Kinsey Millhone Mysteries (Paperback))","A Time to Kill","The Kitchen God's Wife","G Is for Gumshoe (Kinsey Millhone Mysteries (Paperback))","Dawn (Cutler)","Black Notice","The Rainmaker","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","Two for the Dough","The Return of the King (The Lord of the Rings, Part 3)","Kiss the Girls","Chicken Soup for the Soul (Chicken Soup for the Soul)","The Alienist","Zen and the Art of Motorcycle Maintenance: An Inquiry into Values","Watchers","The Bourne Identity","Mystic River","The King of Torts","Wild Animus","The Gunslinger (The Dark Tower, Book 1)","Night Sins","Morality for Beautiful Girls (No.1 Ladies Detective Agency)","Mystic River","The Rescue","The Street Lawyer","Ender's Game (Ender Wiggins Saga (Paperback))","A Wrinkle in Time","Along Came a Spider (Alex Cross Novels)","Message in a Bottle","Rising Sun","American Gods","Three Junes","One True Thing","Bel Canto: A Novel","The Queen of the Damned (Vampire Chronicles (Paperback))","Saving Faith","Fahrenheit 451","Hard Eight : A Stephanie Plum Novel (A Stephanie Plum Novel)","At Home in Mitford (The Mitford Years)","The Mists of Avalon","To Kill a Mockingbird","Tears of the Giraffe (No.1 Ladies Detective Agency)","Back Roads","All That Remains (Kay Scarpetta Mysteries (Paperback))","Life of Pi","Insomnia","The Simple Truth","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Wild Animus","Outlander","Lake Wobegon days","Inner Harbor (Quinn Brothers (Paperback))","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","Neverwhere","The Green Mile","Chocolat","Wicked: The Life and Times of the Wicked Witch of the West","Vinegar Hill (Oprah's Book Club (Paperback))","Animal Dreams","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","Jewel (Oprah's Book Club)","Cruel &amp;amp; Unusual (Kay Scarpetta Mysteries (Paperback))","Artemis Fowl (Artemis Fowl, Book 1)","The Lost Boy: A Foster Child's Search for the Love of a Family","The Celestine Prophecy (Celestine Prophecy)","A Child Called \\It\\\": One Child's Courage to Survive\"","Jewels of the Sun (Irish Trilogy)","The Firm","The Rainmaker","Billy Straight : A Novel","Dragonfly in Amber","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Contact","The Bonfire of the Vanities","Angels &amp;amp; Demons","Congo","Zoya","While I Was Gone","A Thousand Acres (Ballantine Reader's Circle)","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","I Know This Much Is True","Still Waters","Ashes to Ashes","House of Sand and Fog","Jewel (Oprah's Book Club)","Dance upon the Air (Three Sisters Island Trilogy)","Needful Things","D Is for Deadbeat (Kinsey Millhone Mysteries (Paperback))","Jack &amp;amp; Jill (Alex Cross Novels)","Postmortem","Message in a Bottle","The Five People You Meet in Heaven","Point of Origin","A Time to Kill","2nd Chance","Violets Are Blue","Inner Harbor (Quinn Brothers (Paperback))","Remember Me","Roses Are Red (Alex Cross Novels)","Black Notice","Zoya","Disclosure","Invasion","The Last Precinct","Red Dragon","Hornet's Nest","The Andromeda Strain","The Hundred Secret Senses","The Plains of Passage (Earth's Children (Paperback))","Congo","Long After Midnight","Kaleidoscope","Needful Things","The Last Precinct","The Blue Nowhere : A Novel","Point of Origin","The Killing Game: Only One Can Win...and the Loser Dies","A Child Called \\It\\\": One Child's Courage to Survive\"","Vinegar Hill (Oprah's Book Club (Paperback))","Midwives: A Novel","I Know This Much Is True (Oprah's Book Club)","Angels &amp;amp; Demons","River, Cross My Heart","Mr. Murder","The Lovely Bones: A Novel","The Da Vinci Code","Blood Work","Hot Six : A Stephanie Plum Novel (A Stephanie Plum Novel)","SHIPPING NEWS","The Pilot's Wife : A Novel","The Joy Luck Club","While I Was Gone","Angela's Ashes: A Memoir","Five Quarters of the Orange","The Reader","The Secret Life of Bees","Mr. Murder","Fried Green Tomatoes at the Whistle Stop Cafe","House of Sand and Fog","The Poisonwood Bible: A Novel","She's Come Undone (Oprah's Book Club (Paperback))","The Kitchen God's Wife","Wild Animus","Angela's Ashes (MMP) : A Memoir","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","Cradle and All","She's Come Undone (Oprah's Book Club)","The Lovely Bones: A Novel","A Time to Kill","A Prayer for Owen Meany","The Secret Life of Bees","A Fine Balance","One True Thing","A Map of the World","All the Pretty Horses (The Border Trilogy, Vol 1)","The Bonfire of the Vanities","White Oleander : A Novel","Life of Pi","Sophie's World: A Novel About the History of Philosophy","Hannibal","I Is for Innocent","Insomnia","Skipping Christmas","Harry Potter and the Chamber of Secrets (Book 2)","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","Sleepers","All the Pretty Horses (The Border Trilogy, Vol 1)","The Red Tent (Bestselling Backlist)","Anne of Avonlea (Anne of Green Gables Novels (Paperback))","The Brethren","The Tommyknockers","Midwives: A Novel","Moonlight Becomes You","Disclosure","It Was on Fire When I Lay Down on It","The Idiot Girls' Action Adventure Club","All I Really Need to Know","Remember Me","Angela's Ashes (MMP) : A Memoir","The Hours: A Novel","The Book of Ruth (Oprah's Book Club (Paperback))","Insomnia","The Thorn Birds","Before I Say Good-Bye","The Villa","The Pelican Brief","The Book of Ruth (Oprah's Book Club (Paperback))","Good in Bed","Chicken Soup for the Soul (Chicken Soup for the Soul)","Charlotte's Web (Trophy Newbery)","Congo","Girl in Hyacinth Blue","Fried Green Tomatoes at the Whistle Stop Cafe","The Nanny Diaries: A Novel","Secret History","Angela's Ashes (MMP) : A Memoir","The Client","Timeline","The Red Tent (Bestselling Backlist)","The Girls' Guide to Hunting and Fishing","Tara Road","Dude, Where's My Country?","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","How to Be Good","The Rainmaker","Lucky : A Memoir","The Poisonwood Bible: A Novel","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","Bridget Jones : The Edge of Reason","Fast Food Nation: The Dark Side of the All-American Meal","Sisterhood of the Traveling Pants","The Firm","Animal Dreams","Outlander","One for the Money (Stephanie Plum Novels (Paperback))","Hearts In Atlantis","The Next Accident","Interview with the Vampire","Hornet's Nest","Seven Up (A Stephanie Plum Novel)","Chicken Soup for the Soul (Chicken Soup for the Soul)","Lucky : A Memoir","The Notebook","The Joy Luck Club","The Rapture of Canaan","A Walk to Remember","Wild Animus","Suzanne's Diary for Nicholas","Into Thin Air : A Personal Account of the Mt. Everest Disaster","White Oleander : A Novel","Wild Animus","The Surgeon","A Thin Dark Line (Mysteries &amp;amp; Horror)","The Client","The Virgin Suicides","Lord of the Flies","Fast Food Nation: The Dark Side of the All-American Meal","The Girls' Guide to Hunting and Fishing","Fine Things","A Painted House","The Pillars of the Earth","The Clan of the Cave Bear (Earth's Children (Paperback))","The Nanny Diaries: A Novel","Dying for Chocolate (Culinary Mysteries (Paperback))","The Valley of Horses","Bel Canto: A Novel","Silence of the Lambs","Interview with the Vampire","Ashes to Ashes","Flesh and Blood","F Is for Fugitive (Kinsey Millhone Mysteries (Paperback))","The Queen of the Damned (Vampire Chronicles (Paperback))","C Is for Corpse (Kinsey Millhone Mysteries (Paperback))","Contact","Touching Evil","The Pillars of the Earth","When the Wind Blows","The King of Torts","A Map of the World","Night Sins","What Looks Like Crazy On An Ordinary Day","Wild Animus","The Thorn Birds","Dreamcatcher","Face the Fire (Three Sisters Island Trilogy)","The Secret Life of Bees","The Prince of Tides","Back Roads","Skipping Christmas","Vinegar Hill (Oprah's Book Club (Paperback))","Snow Falling on Cedars","The Celestine Prophecy (Celestine Prophecy)","I Know This Much Is True","Shopaholic Ties the Knot","Song of Solomon (Oprah's Book Club (Paperback))","The Pelican Brief","Tears of the Giraffe (No.1 Ladies Detective Agency)","While I Was Gone","Daisy Fay and the Miracle Man","The Book of Ruth (Oprah's Book Club (Paperback))","The Bad Beginning (A Series of Unfortunate Events, Book 1)","L Is for Lawless","Songs in Ordinary Time (Oprah's Book Club (Paperback))","The Joy Luck Club","Angus, Thongs and Full-Frontal Snogging: Confessions of Georgia Nicolson","The Firm","The Red Tent (Bestselling Backlist)","Jewel","Good in Bed","The Body Farm","The Return of the King (The Lord of the Rings, Part 3)","STONES FROM THE RIVER","The Lost Boy: A Foster Child's Search for the Love of a Family","The Book of Ruth (Oprah's Book Club (Paperback))","Rules of Prey","Absolute Power","The Bourne Identity","N Is for Noose","Full House (Janet Evanovich's Full Series)","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","The Horse Whisperer","The Red Tent (Bestselling Backlist)","Blessings","Wish You Well","The Nanny Diaries: A Novel","Pay It Forward","The Killing Game: Only One Can Win...and the Loser Dies","Confessions of a Shopaholic (Summer Display Opportunity)","M Is for Malice","How to Be Good","Sleepers","I Is for Innocent","Stupid White Men ...and Other Sorry Excuses for the State of the Nation!","A Is for Alibi (Kinsey Millhone Mysteries (Paperback))","Evening Class","The Lovely Bones: A Novel","At Home in Mitford (The Mitford Years)","Slaughterhouse Five or the Children's Crusade: A Duty Dance With Death","Isle of Dogs","A Prayer for Owen Meany","Bridget Jones: The Edge of Reason","Kaleidoscope","Secret History","The Horse Whisperer","Sphere","Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson","A Prayer for Owen Meany","A Painted House","Hearts in Atlantis","Midnight Bayou","Dreamcatcher","Engaging The Enemy","Snow Falling on Cedars","She's Come Undone (Oprah's Book Club)","Before I Say Good-Bye","Three Fates","Tara Road","Angela's Ashes: A Memoir","Couplehood","How to Make an American Quilt","Harry Potter and the Sorcerer's Stone (Harry Potter (Paperback))","Breathing Lessons","A Thousand Acres (Ballantine Reader's Circle)","My Gal Sunday","Rising Sun","The Red Tent (Bestselling Backlist)","Icy Sparks","Hideaway","Don't Sweat the Small Stuff and It's All Small Stuff : Simple Ways to Keep the Little Things from Taking Over Your Life (Don't Sweat the Small Stuff Series)","Neuromancer (Remembering Tomorrow)","The Runaway Jury","The Color Purple","Into the Wild","The Next Accident","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","The Client","The Robber Bride","Full Tilt (Janet Evanovich's Full Series)","Airframe","Monster : A Novel (Alex Delaware Novels (Paperback))","1984","The Kitchen God's Wife","B Is for Burglar (Kinsey Millhone Mysteries (Paperback))","The Killing Game: Only One Can Win...and the Loser Dies","Jack &amp;amp; Jill (Alex Cross Novels)","Lightning","A Wrinkle in Time","The Five People You Meet in Heaven","One True Thing","The Da Vinci Code","The Dark Half","Seven Habits Of Highly Effective People","Shopaholic Takes Manhattan (Summer Display Opportunity)","Interview with the Vampire","The Mummy or Ramses the Damned","Jurassic Park","I Know Why the Caged Bird Sings","The Murder Book","The Princess Bride: S Morgenstern's Classic Tale of True Love and High Adventure","Fear Nothing","The Fellowship of the Ring (The Lord of the Rings, Part 1)","The Prince of Tides","\\O\\\" Is for Outlaw\"","What to Expect When You're Expecting (Revised Edition)","High Five (A Stephanie Plum Novel)","The Next Accident","Night Sins","The Lovely Bones: A Novel","The Prince of Tides","House of Sand and Fog","1st to Die: A Novel","Flesh and Blood","Blessings","Still Waters","Seven Up (A Stephanie Plum Novel)","The Lovely Bones: A Novel","Whirlwind (Tyler, Book 1)","A Heartbreaking Work of Staggering Genius","The Lost World","Good in Bed","Hide &amp;amp; Seek","The Pelican Brief","The Joy Luck Club","The Lovely Bones: A Novel","Icy Sparks","The Cardinal of the Kremlin (Jack Ryan Novels)","A Walk to Remember","Confessions of a Shopaholic (Summer Display Opportunity)","SHIPPING NEWS","Like Water for Chocolate: A Novel in Monthly Installments With Recipes, Romances and Home Remedies","The Queen of the Damned (Vampire Chronicles (Paperback))","I Know This Much Is True","Five Quarters of the Orange","Chosen Prey","A Walk to Remember","Snow Falling on Cedars","Let Me Call You Sweetheart","Seven Habits Of Highly Effective People","The Body Farm","Lucky : A Memoir","We Were the Mulvaneys","Before I Say Good-Bye","The Notebook","The Reader","The Plains of Passage (Earth's Children (Paperback))","The Glass Lake","The Last Time They Met : A Novel","All I Really Need to Know","Five Quarters of the Orange","Fine Things","Drowning Ruth (Oprah's Book Club)","White Oleander : A Novel","Secret History","Midnight Bayou","Snow Falling on Cedars","The Tommyknockers","A Prayer for Owen Meany","Harry Potter and the Chamber of Secrets (Book 2)","The Burden of Proof","A Thin Dark Line (Mysteries &amp;amp; Horror)","I'll Be Seeing You","The Witching Hour (Lives of the Mayfair Witches)","Rising Sun","Debt of Honor (Jack Ryan Novels)","Face the Fire (Three Sisters Island Trilogy)","The Rainmaker","The Color Purple","CAT'S EYE","The Summerhouse","Let Me Call You Sweetheart","The Tao of Pooh","Angela's Ashes (MMP) : A Memoir","Wild Animus","The Stone Diaries","Crazy for You","Jurassic Park","House of Sand and Fog","Carolina Moon","Charlotte's Web (Trophy Newbery)","Here on Earth","Loves Music, Loves to Dance","The Simple Truth","The Lottery Winner : Alvirah And Willy Stories","Riptide","Guilty as Sin","Politically Correct Bedtime Stories: Modern Tales for Our Life and Times","Red Dragon","Heaven and Earth (Three Sisters Island Trilogy)","She's Come Undone (Oprah's Book Club (Paperback))","The Hobbit : The Enchanting Prelude to The Lord of the Rings","The Gunslinger (The Dark Tower, Book 1)","STONES FROM THE RIVER","Dolores Claiborne","Hearts in Atlantis","Sea Swept (Quinn Brothers (Paperback))","Three Junes","The Thorn Birds","Big Stone Gap: A Novel (Ballantine Reader's Circle)","Under the Tuscan Sun","Turtle Moon","Scarlet Feather","The Lovely Bones: A Novel","What Looks Like Crazy On An Ordinary Day","Beach Music","The Catcher in the Rye","Divine Secrets of the Ya-Ya Sisterhood: A Novel","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","She's Come Undone (Oprah's Book Club)","Full Tilt (Janet Evanovich's Full Series)","Chicken Soup for the Soul (Chicken Soup for the Soul)","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","Tears of the Moon (Irish Trilogy)","2nd Chance","Drowning Ruth (Oprah's Book Club)","Sanctuary","Atonement : A Novel","Shopaholic Ties the Knot","Icy Sparks","Pretend You Don't See Her","Along Came a Spider (Alex Cross Novels)","The Giver (21st Century Reference)","The Loop","Black Notice","To Kill a Mockingbird","Secrets","A Time to Kill","Anne Frank: The Diary of a Young Girl","Little Altars Everywhere: A Novel","Before I Say Good-Bye","Deja Dead","From Potter's Field","Monster : A Novel (Alex Delaware Novels (Paperback))","Fatal Cure","Neuromancer (Remembering Tomorrow)","The Next Accident","High Five (A Stephanie Plum Novel)","Full House (Janet Evanovich's Full Series)","Riptide","Deja Dead","Empire Falls","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","A Time to Kill","Mystic River","The Return Journey","The Tale of the Body Thief (Vampire Chronicles (Paperback))","The Blue Nowhere : A Novel","Rising Sun","Final Target","The Summerhouse","The Hours: A Novel","The Red Tent (Bestselling Backlist)","The King of Torts","The Weight of Water : A Novel Tag: Author of Resistance and Strange Fits of Passion","The Pilot's Wife : A Novel","The Firm","The Color Purple","The Secret Life of Bees","I'll Be Seeing You","Empire Falls","Balzac and the Little Chinese Seamstress : A Novel","The Dogs of Babel (Today Show Book Club #12)","What to Expect When You're Expecting (Revised Edition)","Bridget Jones: The Edge of Reason","We Were the Mulvaneys","Back Roads","The Kitchen God's Wife","The Bad Place","Shell Seekers","The Rainmaker","Wanderlust","Carolina Moon","A Thin Dark Line (Mysteries &amp;amp; Horror)","I Know This Much Is True","Tom Clancy's Op-Center (Tom Clancy's Op Center (Paperback))","Neverwhere","Silence of the Lambs","The Chamber","Two for the Dough","Rose Madder","The Horse Whisperer","The Cereal Murders","Jewels of the Sun (Irish Trilogy)","The Dark Half","Red Dragon","The Great Gatsby","Kaleidoscope","The Beach House","Seven Habits Of Highly Effective People","To the Nines: A Stephanie Plum Novel","The Burden of Proof","The Lovely Bones: A Novel","Key of Valor (Roberts, Nora. Key Trilogy, 3.)","The Blue Nowhere : A Novel","Dance upon the Air (Three Sisters Island Trilogy)","The Divine Secrets of the Ya-Ya Sisterhood: A Novel","Chicken Soup for the Woman's Soul (Chicken Soup for the Soul Series (Paper))","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","The Angel of Darkness","Where the Heart Is (Oprah's Book Club (Paperback))","Bridget Jones : The Edge of Reason","The Five People You Meet in Heaven","A Painted House","I Know This Much Is True","The Devil Wears Prada : A Novel","River, Cross My Heart","The Angel of Darkness","The Color of Water: A Black Man's Tribute to His White Mother","Rose Madder","The Perfect Storm : A True Story of Men Against the Sea","The Bean Trees","Love in the Time of Cholera (Penguin Great Books of the 20th Century)","To Kill a Mockingbird","Sophie's World: A Novel About the History of Philosophy","Violets Are Blue","A Great Deliverance","Silence of the Lambs","A Prayer for Owen Meany","Bridget Jones : The Edge of Reason","To Kill a Mockingbird","The Reader","Interview with the Vampire","The Mummy or Ramses the Damned","SHIPPING NEWS","The Tommyknockers","Fast Food Nation: The Dark Side of the All-American Meal","Contact","The Fellowship of the Ring (The Lord of the Rings, Part 1)","Lake Wobegon days","Congo","A Prayer for Owen Meany","The Vampire Lestat (Vampire Chronicles, Book II)","The Lovely Bones: A Novel","Girl, Interrupted","The Kitchen God's Wife","The Alienist","All Around the Town","Daisy Fay and the Miracle Man","Bridget Jones: The Edge of Reason","From Potter's Field","White Teeth: A Novel","The Joy Luck Club","1st to Die: A Novel","Cradle and All","The Dark Half","The Summons","Black Notice","Animal Dreams","Long After Midnight","Silence of the Lambs","Debt of Honor (Jack Ryan Novels)","4 Blondes","Wild Animus","A Time to Kill","I Know This Much Is True","Red Dragon","The Reader","The Ugly Duckling","The Devil Wears Prada : A Novel","Big Cherry Holler: A Big Stone Gap Novel (Ballantine Reader's Circle)","Nerd in Shining Armor","Key of Light (Key Trilogy (Paperback))","Face the Fire (Three Sisters Island Trilogy)","The Rapture of Canaan","Dance upon the Air (Three Sisters Island Trilogy)","Snow Falling on Cedars","Shopaholic Takes Manhattan (Summer Display Opportunity)","Hearts in Atlantis","The Firm","At Home in Mitford (The Mitford Years)","She's Come Undone (Oprah's Book Club)","Fast Food Nation: The Dark Side of the All-American Meal","The Valley of Horses","The Other Boleyn Girl","Bridget Jones : The Edge of Reason","Secrets","How to Be Good","Scarlett : The Sequel to Margaret Mitchell's \\Gone With the Wind\\\"\"","Girl with a Pearl Earring","From Potter's Field","A Prayer for Owen Meany","Song of Solomon (Oprah's Book Club (Paperback))"],[3.09,4.6,2.92,0.03,0.99,0.89,0.02,4.71,0.01,0.26,1.53,0.31,0.38,0.65,0.51,0,0.59,0.61,0.07000000000000001,0.51,0.39,0,1.11,0.58,-0,0,0.49,9,6.88,5.99,1.83,1.84,1.25,3.13,1.35,0.01,0.39,4.99,0.75,0.03,1.99,0.07000000000000001,2.2,0.01,4.18,0.89,0.53,1.1,0.3,-0,2.94,1.15,0.86,1.59,0.35,2.72,0.99,0.48,0.57,0.67,0.83,1.08,1.7,1.55,0.96,0.03,0.4,3.05,1.5,2.48,2.01,1.79,0,-0,2.07,0.61,-0,0.45,0.18,2.82,0.01,0.2,3.03,3.47,0.65,1.91,1.37,1.54,1.29,1.65,1.98,0.42,-0,-0,-0,-0,0.08,0.12,0.02,0,0.26,0.13,0.11,0.21,0,1.13,0.39,0.2,0.42,-0,0.82,0.38,0.02,0.38,0.42,0.86,0.68,2.93,1.24,1.32,1.53,0.47,1.41,1.43,1.14,1.35,1.96,0.22,0.2,1.45,0.01,0.42,0.09,-0,0.08,0,0.07000000000000001,0.13,0.12,0.12,0.05,0.01,0,0.4,0.57,0.03,1.72,0,1.04,1.77,1.45,-0,1.71,1.15,2.63,1.85,2.47,3.67,5.2,1.54,1.61,2.78,1.87,1.93,1.3,3.21,0,5.59,0.08,0.37,0.25,0.24,0.35,-0.01,1.07,3.93,4.26,0.51,0.52,0.29,0.4,-0,0,0.62,0.39,0.09,0,0.39,7.61,7.25,2.28,0.15,1.16,3.16,2,0.91,0.07000000000000001,0.4,2.49,1.79,0,1.57,2.26,3.12,1.02,0.01,3.84,2.12,0.43,1.41,0.91,-0,1.89,2.34,-0,0,0.72,0,0.15,0.03,1.13,0.13,0.72,0.03,0.38,-0,0.19,0.73,0.27,1.32,0,0.84,1.67,1.4,1,0.12,0.63,0.83,0.71,0.01,1.05,0.01,1.02,1.15,1.85,1.48,1.1,0.62,1.56,0.58,2.14,-0.04,1.51,1.31,3.51,2.77,3.08,0.36,0.53,0.95,2.37,0.14,0.05,1.55,1.39,4,3.38,2.42,1.26,0.4,2.42,0.72,3.4,1.92,0.08,2.56,1.11,0.64,0.9,0.5,0,1.5,0.74,0.88,1.9,0.26,0.47,0.4,1.65,1.21,2.23,2.36,0.17,1.05,0.73,1.43,-0,1.05,0,1.65,3.04,3.08,3.5,1.41,2.54,0.01,2.95,3.02,2.55,3.07,0,0,3.1,-0,3.37,1.72,1.99,2.72,2.79,0.55,2.9,0.03,1.01,0.14,0.01,-0.05,0.14,0.99,0,3.9,0,0.75,1.01,0.3,0.99,0.47,0.13,-0,0.61,1.04,3.68,0.13,0.19,5.27,0.83,0.01,4.46,4.38,1.92,1.84,2.98,0.36,0,0,0.77,0.67,1.6,0.4,0.54,0,-0,0.32,0.08,0.8,0.78,0.43,-0,0.53,0.61,0.48,0.42,0,1.02,-0,0.03,0.36,1.6,0.98,0.01,0.67,1.37,0.92,1.88,1.46,0.64,0.01,1.16,0.86,0.09,1.67,2,-0.01,0.65,1.2,0,0.61,0,0.62,1.13,1.08,0.79,1.55,1.31,1.12,4.18,3.7,1.3,1.67,2,0.12,0,0.01,0.97,1.34,2.36,0.91,0.63,2.6,1.52,1.05,1.34,1.25,0,0.61,0.01,2.36,3.84,0,-0.05,0.27,0.13,0,0.23,1.77,1.64,1.2,0.06,1.54,1.14,1,0.93,1.05,0.75,1,0,0.29,0.29,0.08,0.29,0.29,0.15,0.27,0.15,0.13,0.47,1.67,0.62,3.88,1.94,1.89,0.36,2.3,2.2,0.04,0,0.05,0.03,0.04,0.08,0,0.05,0,0.05,0.02,0,0.04,0,0.07000000000000001,0.01,0.04,0.01,0.04,0.01,0,0.01,0,0.05,0.04,0.08,0.08,0.03,0.05,0,0.01,0.01,0.01,-0,0,0.01,0.04,0.1,0,1.42,1.65,0,0.19,1.42,1.49,0.16,1.23,0,1.38,1.61,2.97,0.01,1.47,1.47,2.08,1.91,0.14,0.02,2.96,0.07000000000000001,1.65,1.12,0.09,-0.01,1.11,1.25,0.26,0.25,0,1.77,-0,1.61,-0,0.73,1.7,1.32,1.5,1.39,2.3,2,0.24,3.54,2.07,2.44,5.33,0.78,1.91,2.21,2.53,1.79,1.39,2.03,1.63,0.01,1.08,0.09,2.46,0.58,3.15,2.41,3.75,1.71,2.22,3.67,0,0.04,1.32,1.74,1.5,2.74,0.19,1.43,-0,0.75,0,0,0,0,0,0,0,-0,-0,0,0,0,0,0,-0,-0,0,0,5.48,0.01,3.05,5.47,3.61,0.25,4.11,7.63,0.02,1.58,1.01,7.1,4.45,0,1.23,0.03,1.7,1.54,0.65,2,0.34,0,1.03,0.65,-0.02,4.3,2.29,5.16,4.16,6.57,-0,1.64,2.52,-0,1.38,1.17,1.79,1.73,1.65,0.8100000000000001,0.87,2.14,0.04,-0,0.2,0.91,0.83,2.2,2.62,0.35,0.77,1.02,0.88,0.1,0.91,0.05,0.93,0.73,1.09,1.28,0.44,0,1.05,0.05,0.89,0,-0,0.21,1.14,1.09,0,2.93,1.96,2,1.78,0.28,2.36,2.59,2.37,1.01,2.46,2.5,0,1.84,2.44,3.85,3.2,2.78,0.1,0.1,-0,3.18,4,2.26,3.31,2.73,-0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>user_id<\/th>\n      <th>ISBN<\/th>\n      <th>rating<\/th>\n      <th>title<\/th>\n      <th>predicted_rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,4]},{"name":"user_id","targets":0},{"name":"ISBN","targets":1},{"name":"rating","targets":2},{"name":"title","targets":3},{"name":"predicted_rating","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s look at the distribution of these the predicted ratings</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_data_l2<span class="sc">$</span>predicted_rating,  <span class="at">main =</span> <span class="st">"Histogram of the predicted ratings for all observations in the</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="st">     test data using the matrix factorization model with L2 regularization"</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted rating"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Most of the predicted ratings also lies between 0 and 1. And the number of observations decreases as the rating gets higher. The model is also producing raw predictions without any constraints or normalization, as there is a number of observations with predicted rating less than 0, but none with more than a rating of 10.</p>
</section>
</section>
<section id="ensemble-model-of-the-2-methods" class="level2">
<h2 class="anchored" data-anchor-id="ensemble-model-of-the-2-methods">Ensemble model of the 2 methods</h2>
</section>
</section>
<section id="get-the-predictions-from-all-ib-cf-and-ub-cf-models" class="level1">
<h1>Get the predictions from all IB-CF and UB-CF models</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign weight based on observed prediction performance</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)  <span class="co"># More weight to IBCF</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to predict ratings using an ensemble approach, using weights</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>predict_ratings_ensemble <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, similarity_matrix, item_similarity_matrix, rating_matrix, <span class="at">k =</span> <span class="dv">10</span>, weights) {</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get predictions from each method</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  ubcf_predictions <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ubcf</span>(user_id, similarity_matrix, rating_matrix, k)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  ibcf_predictions <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ibcf</span>(user_id, item_similarity_matrix, rating_matrix, k)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mf_predictions &lt;- rs$predict(rating_data)</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine predictions using weighted average</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  combined_predictions <span class="ot">&lt;-</span> (weights[<span class="dv">1</span>] <span class="sc">*</span> ubcf_predictions <span class="sc">+</span> </span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>                           weights[<span class="dv">2</span>] <span class="sc">*</span> ibcf_predictions )</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_predictions)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ratings using the ensemble model</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>predicted_ratings <span class="ot">&lt;-</span> <span class="fu">predict_ratings_ensemble</span>(<span class="st">"6242"</span>, similarity_matrix, item_similarity_matrix, final_data_matrix, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">weights =</span> weights)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the predictions</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(predicted_ratings, <span class="at">main =</span> <span class="st">"Histogram of the predicted ratings for user_id 6242</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="st">     using the ensemble model"</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Book_recommender_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The Matrix factorization model with regularization works well. We were not able to test the accuracy of the UB-CF and the IB-CF models. This could be a project for the future to test all four model’s accuracy and the create a website using the most accurate one or an ensemble of the top two best performing. The website can have a log in that will capture the user’s ID and base on the book they searched we can also give the top 10 recommendations. To incoporated all the other books and users that were not included in this model, we can do a cluster analysis.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>